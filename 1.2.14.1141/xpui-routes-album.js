"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{11480:(e,i,a)=>{a.r(i),a.d(i,{default:()=>Ee});var n=a(59496),t=a(99766),l=a(80519),s=a(64641),r=a(73448),o=a(18474),c=a(97653),d=a(84432),u=a(55740),m=a(57579),g=a(3819),h=a(94942),k=a(28725),p=a(25027),x=a(13390),j=a(42673),b=a(85583),v=a(59476),y=a(86739),f=a(17286),N=a(99358),C=a(20798),S=a(11433),w=a(65123),F=a(81622),I=a(4637);const U=({children:e,content:i,onIntercept:a=(()=>{})})=>{const t=(0,F.g)();let l;try{l=n.Children.only(e)}catch(i){return(0,I.jsx)(I.Fragment,{children:e})}return t?(0,I.jsx)(w.Nt,{trigger:"click",action:"open",placement:"bottom",offset:[0,20],content:i,children:n.cloneElement(l,{onClick:a})}):(0,I.jsx)(I.Fragment,{children:e})};var D=a(73630),T=a(89120),M=a(26254),A=a(91560),L=a(71425),P=a(57265);const B="WHINADihyTCx2VFxwY8X",O=({title:e,description:i})=>{const a=(0,t.I0)(),l=(0,M.qT)(),r=(0,P.o)();return(0,n.useEffect)((()=>{r({intent:"open-upsell",type:"view"})}),[r]),(0,I.jsx)(w.yv,{children:(0,I.jsxs)("div",{className:B,children:[(0,I.jsx)(s.D,{as:"p",variant:"cello",children:e}),(0,I.jsx)(s.D,{as:"p",variant:"mesto",children:i}),(0,I.jsxs)("div",{children:[(0,I.jsx)(D.o,{onClick:()=>{r({intent:"close-upsell",type:"click"}),l({type:"close"})},children:u.ag.get("action-trigger.button.not-now")}),(0,I.jsx)(T.D,{onClick:()=>{r({intent:"login",type:"click"}),a((0,L.sX)())},children:u.ag.get("login")})]})]})})},V=e=>(0,I.jsx)(A.ZP,{value:"tooltip-with-cta",children:(0,I.jsx)(O,{...e})}),E=({uri:e,...i})=>{const a=(0,C.j)();return(0,I.jsx)(U,{content:(0,I.jsx)(V,{title:u.ag.get("action-trigger.save-library"),description:u.ag.get("action-trigger.save-album")}),onIntercept:()=>a.storeAction(N.wH,{operation:S.pT.ADD,uris:[e]}),children:(0,I.jsx)(g.H,{...i})})};var q=a(6123),z=a(69496);const R={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var Q=a(39320);const Z="iEG0moJ3mt1_j9Lho7MA",$=({albumName:e,albumURI:i})=>{const{data:a}=(n={uri:i},t={cacheTime:5*z.y},(0,z.a)(R,n,t));var n,t;const l=a?.albumUnion&&"merch"in a.albumUnion?a?.albumUnion?.merch?.items:[];return l&&l?.length>0?(0,I.jsx)("div",{className:"contentSpacing",children:(0,I.jsx)("div",{className:Z,children:(0,I.jsx)(Q.s,{id:e,uri:i,merchItems:l,merchVariant:"Album page merch items"})})}):null};var _=a(42203),H=a(17140),X=a(67033),Y=a(2651),W=a(2238),G=a(41328),J=a(61649),K=a(85018),ee=a(82487),ie=a(55207),ae=a(4302),ne=a(57115),te=a(72407),le=a(48593);const se=864e5,re=365.25*se;var oe=a(7071),ce=a(2851),de=a(98474),ue=a(44893),me=a(69129),ge=a(77269),he=a(65391);const ke="TCmZzqInstJMZjkHgnw3",pe="PeNI572tTpqsN23o3QhJ",xe="oUsSfFiifMPXqW0kHjR6",je="XKvEMQZlPfPncTqiitM5",be="GdbPVlmUCW0Q6ZZ0z0wh",ve="Hu7O5y7x5c7wUYFbnIoS",ye=n.memo((function(e){const{images:i,title:a,isOpen:t,onClose:l}=e,s=(0,n.useMemo)((()=>(0,he.X)(i,{desiredSize:1e4})),[i]);return s?(0,I.jsx)(me.Z,{className:ke,isOpen:t,onRequestClose:l,animation:{modal:{base:je,afterOpen:be,beforeClose:ve}},animated:!0,children:(0,I.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:pe,children:[(0,I.jsx)(ge.E,{loading:"eager",alt:a,src:s.url,className:xe}),(0,I.jsx)(D.o,{onClick:l,semanticColor:"textBase",children:u.ag.get("web-player.cover-art-modal.close")})]})}):null}));var fe=a(76163),Ne=a(65980),Ce=a(45743);const Se=({releases:e})=>(0,I.jsx)(Ne.v,{children:e.map((e=>(0,I.jsx)(Ce.s,{role:"menuitem",to:(0,fe.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))});var we=a(55584),Fe=a(43245),Ie=a(12073);const Ue="n8Bz0c0v17whD3KfMdOk",De="zddjxV2lX9ukNM5QXloA",Te="lVqlPjQLuQhK2flsxB78",Me="O_EguRjsZ4uI1hHamkOA",Ae="jcaQQxoVnuuhtVwDJU1R",Le="fLS8v3_EfBadEerbGVoR",Pe="in4OjUTflcsoj9RUpf05",Be=n.lazy((()=>a.e(3233).then(a.bind(a,36703))));function Oe(e){switch(e){case Fe.V.Single:return u.ag.get("single");case Fe.V.Ep:return u.ag.get("ep");case Fe.V.Compilation:return u.ag.get("compilation");case Fe.V.Album:default:return u.ag.get("album")}}const Ve=({uri:e,album:i})=>{const a=(0,l.TH)(),f=(0,P.o)(),N=(0,H.k)(),C=(0,ee.y)(),{spec:S,logger:w,UBIFragment:F}=(0,ne.fU)(d.createDesktopAlbumEventFactory,{data:{uri:e}}),U=(0,n.useMemo)((()=>S.trackListFactory()),[S]),D=(0,n.useMemo)((()=>S.moreByArtistShelfFactory()),[S]),T=n.useMemo((()=>S.actionBarFactory()),[S]),M=i.moreAlbumsByArtist,[A,L]=(0,ee.Z)(e),B=parseInt(new URLSearchParams((0,l.TH)().search).get("index")||"0",10),O=(0,_.Y)(e),{usePlayContextItem:V,togglePlay:z,isPlaying:R,isActive:Q}=(0,ie.n)({uri:O},{featureIdentifier:"album"}),Z=(0,n.useCallback)((()=>{const i=(0,Y.aK)({isPlaying:R,isActive:Q,spec:T.playButtonFactory(),logger:w,uri:e});z({loggingParams:i})}),[R,Q,z,T,w,e]),K=(0,n.useCallback)((async()=>{let i;const a=T.saveButtonFactory();i=A?a.hitDislike({itemToBeDisliked:e}):a.hitLike({itemToBeLiked:e}),w.logInteraction(i),f({targetUri:e,intent:A?"unsave":"save",type:"click"});try{await L(!A)}catch{}}),[f,e,A,L,T,w]),me=(0,n.useCallback)(((e,i)=>{if(S){const e=S.headerFactory().artistNameFactory().hitUiNavigate({destination:i.creator.uri});w.logInteraction(e)}}),[w,S]),{isOpen:ge,openModal:he,closeModal:ke}=(()=>{const[e,i]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>i(!0)),[]),closeModal:(0,n.useCallback)((()=>i(!1)),[])}})(),pe=(0,c.W6)(de.DU,{loadingValue:!1})?{onClick:he,ariaLabel:u.ag.get("web-player.album.open_coverart_modal")}:{},xe=(0,n.useCallback)((()=>new URLSearchParams(a.search.slice(1)).get("highlight")||""),[a.search]),je=i.uri,be=i.name,ve=i.albumType,fe=i.release?.date,Ne=i.nrTracks,Ce=i.images,we=i.extractedColors?.colorRaw.hex,Fe=i.artists,Ve=i.isPlayable,Ee=i.isCatalogueRestricted,qe=i.copyright.items,ze=i.courtesyLine,Re=i.duration.durationMs,Qe=i.duration.isEstimate,Ze=xe(),$e=(0,t.v9)(ue.Gg),_e=$e.overrides?.locale??u.ag.getLocale(),He=(0,ce.k)({uri:e,type:"locale"}),Xe=(0,ae.OT)({albumName:be,albumType:ve,albumArtists:Fe.map((e=>e.name)).join(u.ag.getSeparator()),shouldLocalize:He,i18n:u.ag});(0,X.Y5)(we||null);const Ye=function(e){return(0,n.useMemo)((()=>{if(!e?.date)return null;if("day"===e.precision){const i=new Date(e.date),a=(new Date).getTime()-i.getTime(),n=a%re;return n<3.5*se||n>312552e5?Math.round(a/re):null}return null}),[e])}(i.release);return(0,I.jsxs)("section",{className:Ue,"data-testid":"album-page",children:[(0,I.jsx)(j.$,{children:Xe}),null!==Ye?(0,I.jsx)(n.Suspense,{fallback:null,children:(0,I.jsx)(Be,{colorLight:i?.extractedColors?.colorLight.hex,colorDark:i?.extractedColors?.colorDark.hex,name:be,years:Ye})}):null,(0,I.jsxs)(b.gF,{backgroundColor:we,children:[(0,I.jsxs)(v.W,{children:[(0,I.jsx)(q.$,{size:"md",onClick:()=>z(),disabled:!Ve,isPlaying:R,uri:e}),(0,I.jsx)(y.i,{text:be,dragUri:e,dragLabel:be})]}),(0,I.jsx)(W._,{menu:(0,I.jsx)(x.Y,{uri:i.uri,artistUri:Fe?.[0]?.uri,sharingInfo:i.sharingInfo}),children:(0,I.jsx)(b.Oz,{dragUri:je,images:Ce,name:be,placeholderType:"album",...pe})}),(0,I.jsxs)(b.sP,{children:[(0,I.jsx)(s.D,{variant:"mestoBold",children:Oe(ve)}),(0,I.jsx)(W._,{menu:(0,I.jsx)(x.Y,{uri:i.uri,artistUri:Fe?.[0]?.uri,sharingInfo:i.sharingInfo}),children:(0,I.jsx)(b.xd,{dragUri:i.uri,dragLabel:i.name,children:be})}),(0,I.jsx)(b.QS,{creators:Fe,onCreatorClick:me,releaseDate:fe,totalTracks:Ne,durationMilliseconds:Re,isEstimatedDuration:Qe})]})]}),(0,I.jsx)(m.o,{backgroundColor:we,children:(0,I.jsxs)(m.F,{children:[(0,I.jsx)(q.$,{onClick:Z,disabled:!Ve,isPlaying:R,size:"lg",uri:e}),(0,I.jsx)(E,{isAdded:!!A,onClick:K,disabled:!N&&!C?.getCapabilities().canModifyOffline,size:g.q.md,uri:e}),(0,I.jsx)(h.o,{uri:e,isFollowing:!!A,onClick:(i,a)=>(0,Y.l7)(a,T.downloadButtonFactory(),w,e),onFollow:K,size:h.q.md}),(0,I.jsx)(G.y,{onShow:()=>(0,Y.qq)(T,w),menu:(0,I.jsx)(x.Y,{uri:i.uri,artistUri:Fe?.[0]?.uri,sharingInfo:i.sharingInfo}),children:(0,I.jsx)(k.MoreButton,{label:u.ag.get("more.label.context",be)})})]})}),Ee?(0,I.jsxs)("div",{className:De,children:[(0,I.jsx)(s.D,{as:"h2",variant:"cello",className:Te,children:u.ag.get("windowed.product-album-header")}),(0,I.jsx)("div",{className:Me,children:u.ag.get("windowed.product-album-description")})]}):null,(0,I.jsxs)("div",{className:"contentSpacing",children:[(0,I.jsx)(F,{spec:U,children:(0,I.jsx)(le.L,{ariaLabel:be,nrTracks:(0,Ie.y)(i.discs)?i.discs.totalCount+Ne:Ne,discs:i.discs,albumUri:je,highlightUri:Ze,scrollToIndex:B,usePlayContextItem:V,initalTracks:i.items})}),(0,I.jsxs)("div",{className:Pe,children:[(0,I.jsxs)("div",{children:[fe&&(0,I.jsx)(s.D,{as:"p",variant:"mesto",children:(0,te.BI)((0,te.RX)(fe),_e,{year:"numeric",month:"long",day:"numeric"})}),(0,I.jsx)(J.k,{copyrights:qe,courtesyLine:ze})]}),i.releases.items.length>0&&(0,I.jsx)(W.x,{menu:(0,I.jsx)(Se,{releases:i.releases.items}),children:(e,a,n)=>(0,I.jsxs)("button",{ref:n,className:Le,type:"button",onClick:a,children:[(0,I.jsx)(s.D,{variant:"mesto",children:u.ag.get("album-page.more-releases",i.releases.items.length)}),e?(0,I.jsx)(r.U,{iconSize:16}):(0,I.jsx)(o.i,{iconSize:16})]})})]})]}),(0,I.jsx)($,{albumName:be,albumURI:je}),(0,I.jsx)(I.Fragment,{children:M?.length>0&&(0,I.jsx)("div",{className:"contentSpacing",children:(0,I.jsx)(F,{spec:D,children:(0,I.jsx)(oe.q,{index:0,id:"more-albums",className:Ae,title:u.ag.get("album-page.more-by-artist",Fe?.[0]?.name),total:M.length,seeAllUri:`${Fe?.[0]?.uri.replace("artist","app:artist")}:discography`,seeAllLabel:u.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:M.map(((e,i)=>(0,I.jsx)(p.i,{index:i,artists:Fe,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})})}),(0,I.jsx)(ye,{title:Xe,isOpen:ge,onClose:ke,images:Ce})]})},Ee=n.memo((function(){const{albumId:e}=(0,l.UO)(),i=`spotify:album:${e}`,{loading:a,error:n,data:t,canLoadOffline:s}=(0,we.j)(i);return a||!t?(0,I.jsx)(f.h,{hasError:null!==n,loadOffline:s,errorMessage:u.ag.get("error.not_found.title.album")}):(0,I.jsx)(K.fd,{surface:K.Tg.ALBUM,uris:[i],children:(0,I.jsx)(Ve,{uri:i,album:t})})}))},61649:(e,i,a)=>{a.d(i,{k:()=>s});var n=a(64641);const t="rTMkDBDp47Eo12ZEQv4U";var l=a(4637);const s=({copyrights:e,courtesyLine:i})=>{const a=(e||[]).map(((e,i)=>{const a=e.text.replace(/^(\(C\)\s+)/,"").replace(/^(\(P\)\s+)/,"").replace(/^(©\s+)/,"").replace(/^(℗\s+)/,"");let t;return t="C"===e.type?"©":"P"===e.type?"℗":`(${e.type})`,(0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:`${t} ${a}`},i)}));return i&&a.unshift((0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:i},a.length)),(0,l.jsx)("div",{className:t,children:a})}}}]);
//# sourceMappingURL=xpui-routes-album.js.map