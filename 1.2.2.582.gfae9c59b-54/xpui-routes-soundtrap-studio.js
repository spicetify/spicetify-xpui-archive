"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3780],{59194:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var s=r(59496),n=r(84875),o=r.n(n),c=r(77646),i=r(46439),a=r(88585),u=r.n(a),l=r(1740),p=r(97926),d=r(19435),f=r(99208),w=r(67628),h=r(36899);var I=r(74366),m=r(45462),g=r(39189),j=r(15696);const k="_8NXEiIW8UUvsBVNhHdc",y="pZytOOt4d5hSOwPD8A_V";var b=r(4637);const v=(0,s.memo)((()=>{const e=(0,f.n)(),{projectId:t,songId:r}=(0,i.UO)(),n=(0,s.useRef)(null),a=(0,c.I0)(),v=(0,h.z)(),S=(0,i.s0)(),E=(0,s.useMemo)((()=>[["showtippopups",0],["workflow","cover"],["workflowSongId",r]].map((([e,t])=>`${e}=${t}`)).join("&")),[r]),U=(0,c.v9)((e=>e.session.user?.uri)),P=u().from(U).toURLPath(!0),[$,O]=(0,s.useState)(null),{route:x,error:C}=(({redirectUri:e})=>{const t=(0,h.z)(),[r,n]=(0,s.useState)(""),[o,c]=(0,s.useState)(null);return(0,s.useEffect)((()=>{(async()=>{try{const{token:r}=await t.requestAccountLinkToken();n(`https://www.soundtrap.com/spotify/accountlink/?redirect=${encodeURIComponent(e)}&token=${r}`)}catch(e){c("Something went wrong while trying link your account")}})()}),[t,e]),{route:r,error:o}})({redirectUri:`https://www.soundtrap.com/studio/${t}/?${E}`}),{resetMainView:L,collapseMainView:_}=(0,w.i)(),M=(0,m.g)(),V=(0,g.Y)((e=>e?.hasContext&&!e?.isPaused));(0,s.useEffect)((()=>{const e=n.current;return v.setIframe(e),()=>{v.setIframe(null)}}),[n,v,a]),(0,j.I)(I.O.EXIT,(()=>{S(-1)})),(0,j.I)(I.O.PUBLISH,(async({data:e})=>{const t=!e.title||!e.projectId;if(O(null),t)O("Cannot publish project, title or projectId are missing.");else try{await v.publish({projectId:e.projectId,title:e.title,isPrivate:!0===e.isPrivate}),S(P,{replace:!0,state:{referrer:"soundtrap_publish",newProjectId:e.projectId}})}catch(e){O("Something went wrong while trying to publish the project.")}})),(0,s.useEffect)((()=>{V&&M?.pause()}),[V,M]),(0,s.useEffect)((()=>(_(),L)),[]);const z=C??$;return z?(0,b.jsx)(d.h,{hasError:!0,errorMessage:z}):(0,b.jsxs)(s.Suspense,{fallback:null,children:[(0,b.jsx)(p.$,{children:l.ag.get("playlist.page-title")}),(0,b.jsx)("iframe",{ref:n,src:x,className:o()(k,{[y]:e}),allow:"microphone https://www.soundtrap.com/studio;",title:"Soundtrap"})]})}))},15696:(e,t,r)=>{r.d(t,{I:()=>o});var s=r(59496),n=r(36899);function o(e,t){const r=(0,n.z)();(0,s.useEffect)((()=>{const s=r.getEvents(),n=e=>t(e);return s.addListener(e,n),()=>{s.removeListener(e,n)}}),[e,r,t])}}}]);
//# sourceMappingURL=xpui-routes-soundtrap-studio.js.map