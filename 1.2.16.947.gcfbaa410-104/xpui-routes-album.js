"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{54985:(e,a,i)=>{i.d(a,{g:()=>s});var n=i(51697),t=i(26790),l=i(4637);const s=({children:e})=>{const a=(0,t.jh)()===t.Uo.SMALL?"mesto":"mestoBold";return(0,l.jsx)(n.D,{variant:a,children:e})}},22456:(e,a,i)=>{i.d(a,{x:()=>m});var n=i(59496),t=i(33960),l=i(35960),s=i(7991),r=i(57678),o=i(39667),c=i(8591),d=i(4637);const m=({children:e,action:a,uri:i})=>{const m=(0,l.g)(),u=(0,r.j)();let g;const h=()=>{const e={triggerId:c.K,triggerAction:{type:a}};o.y.set((a=>({...a,...e}))),u.storeAction(s.wH,{operation:t.pT.ADD,uris:[i]})};try{g=n.Children.only(e)}catch(a){return(0,d.jsx)(d.Fragment,{children:e})}return m?n.cloneElement(g,{onClick:h}):(0,d.jsx)(d.Fragment,{children:e})}},31885:(e,a,i)=>{i.r(a),i.d(a,{default:()=>we});var n=i(59496),t=i(83792),l=i(97601),s=i(51697),r=i(88559),o=i(21054),c=i(9990),d=i(80576),m=i(94633),u=i(28489),g=i(26156),h=i(70304),k=i(7018),p=i(20456),x=i(29915),b=i(75132),y=i(68224),j=i(89723);const v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var f=i(72009);const N="iEG0moJ3mt1_j9Lho7MA";var C=i(4637);const S=({albumName:e,albumURI:a})=>{const{data:i}=(n={uri:a},t={cacheTime:5*j.y},(0,j.a)(v,n,t));var n,t;const l=i?.albumUnion&&"merch"in i.albumUnion?i?.albumUnion?.merch?.items:[];return l&&l?.length>0?(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)("div",{className:N,children:(0,C.jsx)(f.s,{id:e,uri:a,merchItems:l,merchVariant:"Album page merch items"})})}):null};var U=i(23419),F=i(53851),I=i(40981),w=i(62768),M=i(4635),A=i(13138),P=i(24966),T=i(34046),D=i(62510),L=i(64689),B=i(46927),V=i(98440),O=i(99750),E=i(70706),z=i(22456),R=i(18112),q=i(7442),_=i(34198),Q=i(93019),$=i(47948),Z=i(99550);const H=n.memo((function({uri:e,togglePlay:a,isPlaying:i,isActive:t,spec:l,logger:s,backgroundColor:r,name:o,artists:d,isPlayable:u,sharingInfo:h}){const k=(0,R.o)(),p=(0,q.k)(),x=(0,L.y)(),b=(0,n.useMemo)((()=>l.actionBarFactory()),[l]),[j,v]=(0,L.Z)(e),f=(0,n.useCallback)((()=>{const n=(0,_.aK)({isPlaying:i,isActive:t,spec:b.playButtonFactory(),logger:s,uri:e});a({loggingParams:n})}),[i,t,a,b,s,e]),N=(0,n.useCallback)((async()=>{let a;const i=b.saveButtonFactory();a=j?i.hitDislike({itemToBeDisliked:e}):i.hitLike({itemToBeLiked:e}),s.logInteraction(a),k({targetUri:e,intent:j?"unsave":"save",type:"click"});try{await v(!j)}catch{}}),[k,e,j,v,b,s]),S=(0,c.W6)($.eKc,{loadingValue:!1});return(0,C.jsx)(B.o,{backgroundColor:r,children:(0,C.jsxs)(B.F,{children:[(0,C.jsx)(y.$,{onClick:f,disabled:!u,isPlaying:i,size:"lg",uri:e}),S&&(0,C.jsx)(Z.K,{entityName:o,contextUri:e,activationPlacement:"bottomEnd"}),(0,C.jsx)(z.x,{uri:e,action:Q.sr.SAVE_ALBUM,children:(0,C.jsx)(V.H,{isAdded:!!j,onClick:N,disabled:!p&&!x?.getCapabilities().canModifyOffline,size:V.q.md})}),(0,C.jsx)(O.o,{uri:e,isFollowing:!!j,onClick:(a,i)=>(0,_.l7)(i,b.downloadButtonFactory(),s,e),onFollow:N,size:O.q.md}),(0,C.jsx)(I.ClickToggleContextMenu,{onShow:()=>(0,_.qq)(b,s),menu:(0,C.jsx)(g.Y,{uri:e,artistUri:d?.[0]?.uri,sharingInfo:h}),children:(0,C.jsx)(E.MoreButton,{label:m.ag.get("more.label.context",o)})})]})})}));var K=i(56946);const Y=864e5,W=365.25*Y;var X=i(54985),G=i(12463),J=i(72951),ee=i(7554),ae=i(6285),ie=i(1541),ne=i(20549),te=i(34997);const le="TCmZzqInstJMZjkHgnw3",se="PeNI572tTpqsN23o3QhJ",re="oUsSfFiifMPXqW0kHjR6",oe="XKvEMQZlPfPncTqiitM5",ce="GdbPVlmUCW0Q6ZZ0z0wh",de="Hu7O5y7x5c7wUYFbnIoS",me=n.memo((function(e){const{images:a,title:i,isOpen:t,onClose:l}=e,s=(0,n.useMemo)((()=>(0,te.X)(a,{desiredSize:1e4})),[a]);return s?(0,C.jsx)(ie.Z,{className:le,isOpen:t,onRequestClose:l,animation:{modal:{base:oe,afterOpen:ce,beforeClose:de}},animated:!0,children:(0,C.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:se,children:[(0,C.jsx)(ne.E,{loading:"eager",alt:i,src:s.url,className:re}),(0,C.jsx)(ae.o,{onClick:l,semanticColor:"textBase",children:m.ag.get("web-player.cover-art-modal.close")})]})}):null}));var ue=i(14887),ge=i(74433),he=i(30477);const ke=({releases:e})=>(0,C.jsx)(ge.v,{children:e.map((e=>(0,C.jsx)(he.s,{role:"menuitem",to:(0,ue.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))});var pe=i(47419),xe=i(11879),be=i(915);const ye="n8Bz0c0v17whD3KfMdOk",je="zddjxV2lX9ukNM5QXloA",ve="lVqlPjQLuQhK2flsxB78",fe="O_EguRjsZ4uI1hHamkOA",Ne="jcaQQxoVnuuhtVwDJU1R",Ce="fLS8v3_EfBadEerbGVoR",Se="in4OjUTflcsoj9RUpf05",Ue=n.lazy((()=>i.e(4316).then(i.bind(i,54316))));function Fe(e){switch(e){case xe.V.Single:return m.ag.get("single");case xe.V.Ep:return m.ag.get("ep");case xe.V.Compilation:return m.ag.get("compilation");case xe.V.Album:default:return m.ag.get("album")}}const Ie=({uri:e,album:a})=>{const i=(0,l.TH)(),{spec:b,logger:j,UBIFragment:v}=(0,T.fU)(d.createDesktopAlbumEventFactory,{data:{uri:e}}),f=(0,n.useMemo)((()=>b.trackListFactory()),[b]),N=(0,n.useMemo)((()=>b.moreByArtistShelfFactory()),[b]),M=a.moreAlbumsByArtist,L=parseInt(new URLSearchParams((0,l.TH)().search).get("index")||"0",10),B=(0,U.Y)(e),{usePlayContextItem:V,togglePlay:O,isPlaying:E,isActive:z}=(0,A.n)({uri:B},{featureIdentifier:"album"}),R=(0,n.useCallback)(((e,a)=>{if(b){const e=b.headerFactory().artistNameFactory().hitUiNavigate({destination:a.creator.uri});j.logInteraction(e)}}),[j,b]),{isOpen:q,openModal:_,closeModal:Q}=(()=>{const[e,a]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>a(!0)),[]),closeModal:(0,n.useCallback)((()=>a(!1)),[])}})(),Z=(0,c.W6)($.DUY,{loadingValue:!1})?{onClick:_,ariaLabel:m.ag.get("web-player.album.open_coverart_modal")}:{},ae=(0,n.useCallback)((()=>new URLSearchParams(i.search.slice(1)).get("highlight")||""),[i.search]),ie=a.uri,ne=a.name,te=a.albumType,le=a.release?.date,se=a.nrTracks,re=a.images,oe=a.extractedColors?.colorRaw.hex,ce=a.artists,de=a.isPlayable,ue=a.isCatalogueRestricted,ge=a.copyright.items,he=a.courtesyLine,pe=a.duration.durationMs,xe=a.duration.isEstimate,Ie=ae(),we=(0,t.v9)(ee.Gg),Me=we.overrides?.locale??m.ag.getLocale(),Ae=(0,J.k)({uri:e,type:"locale"}),Pe=(0,P.OT)({albumName:ne,albumType:te,albumArtists:ce.map((e=>e.name)).join(m.ag.getSeparator()),shouldLocalize:Ae,i18n:m.ag});(0,F.Y5)(oe||null);const Te=function(e){return(0,n.useMemo)((()=>{if(!e?.date)return null;if("day"===e.precision){const a=new Date(e.date),i=(new Date).getTime()-a.getTime(),n=i%W;return n<3.5*Y||n>312552e5?Math.round(i/W):null}return null}),[e])}(a.release);return(0,C.jsxs)("section",{className:ye,"data-testid":"album-page",children:[(0,C.jsx)(h.$,{children:Pe}),null!==Te?(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(Ue,{colorLight:a?.extractedColors?.colorLight.hex,colorDark:a?.extractedColors?.colorDark.hex,name:ne,years:Te})}):null,(0,C.jsxs)(k.gF,{backgroundColor:oe,children:[(0,C.jsxs)(p.W,{children:[(0,C.jsx)(y.$,{size:"md",onClick:()=>O(),disabled:!de,isPlaying:E,uri:e}),(0,C.jsx)(x.i,{text:ne,dragUri:e,dragLabel:ne})]}),(0,C.jsx)(I._,{menu:(0,C.jsx)(g.Y,{uri:a.uri,artistUri:ce?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,C.jsx)(k.Oz,{dragUri:ie,images:re,name:ne,placeholderType:"album",...Z})}),(0,C.jsxs)(k.sP,{children:[(0,C.jsx)(X.g,{children:Fe(te)}),(0,C.jsx)(I._,{menu:(0,C.jsx)(g.Y,{uri:a.uri,artistUri:ce?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,C.jsx)(k.xd,{dragUri:a.uri,dragLabel:a.name,scaleAtMinWidth:k.vz,children:ne})}),(0,C.jsx)(k.QS,{creators:ce,onCreatorClick:R,releaseDate:le,totalTracks:se,durationMilliseconds:pe,isEstimatedDuration:xe})]})]}),(0,C.jsx)(H,{backgroundColor:oe,uri:e,togglePlay:O,isPlaying:E,isActive:z,spec:b,logger:j,sharingInfo:a.sharingInfo,name:a.name,artists:a.artists,isPlayable:a.isPlayable}),ue?(0,C.jsxs)("div",{className:je,children:[(0,C.jsx)(s.D,{as:"h2",variant:"cello",className:ve,children:m.ag.get("windowed.product-album-header")}),(0,C.jsx)("div",{className:fe,children:m.ag.get("windowed.product-album-description")})]}):null,(0,C.jsxs)("div",{className:"contentSpacing",children:[(0,C.jsx)(v,{spec:f,children:(0,C.jsx)(K.L,{ariaLabel:ne,nrTracks:(0,be.y)(a.discs)?a.discs.totalCount+se:se,discs:a.discs,albumUri:ie,highlightUri:Ie,scrollToIndex:L,usePlayContextItem:V,initalTracks:a.items})}),(0,C.jsxs)("div",{className:Se,children:[(0,C.jsxs)("div",{children:[le&&(0,C.jsx)(s.D,{as:"p",variant:"mesto",children:(0,D.BI)((0,D.RX)(le),Me,{year:"numeric",month:"long",day:"numeric"})}),(0,C.jsx)(w.k,{copyrights:ge,courtesyLine:he})]}),a.releases.items.length>0&&(0,C.jsx)(I.x,{menu:(0,C.jsx)(ke,{releases:a.releases.items}),children:(e,i,n)=>(0,C.jsxs)("button",{ref:n,className:Ce,type:"button",onClick:i,children:[(0,C.jsx)(s.D,{variant:"mesto",children:m.ag.get("album-page.more-releases",a.releases.items.length)}),e?(0,C.jsx)(r.U,{iconSize:16}):(0,C.jsx)(o.i,{iconSize:16})]})})]})]}),(0,C.jsx)(S,{albumName:ne,albumURI:ie}),(0,C.jsx)(C.Fragment,{children:M?.length>0&&(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)(v,{spec:N,children:(0,C.jsx)(G.q,{index:0,id:"more-albums",className:Ne,title:m.ag.get("album-page.more-by-artist",ce?.[0]?.name),total:M.length,seeAllUri:`${ce?.[0]?.uri.replace("artist","app:artist")}:discography`,seeAllLabel:m.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:M.map(((e,a)=>(0,C.jsx)(u.i,{index:a,artists:ce,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})})}),(0,C.jsx)(me,{title:Pe,isOpen:q,onClose:Q,images:re})]})},we=n.memo((function(){const{albumId:e}=(0,l.UO)(),a=`spotify:album:${e}`,{loading:i,error:n,data:t,canLoadOffline:s}=(0,pe.j)(a);return i||!t?(0,C.jsx)(b.h,{hasError:null!==n,loadOffline:s,errorMessage:m.ag.get("error.not_found.title.album")}):(0,C.jsx)(M.fd,{surface:M.Tg.ALBUM,uris:[a],children:(0,C.jsx)(Ie,{uri:a,album:t})})}))},62768:(e,a,i)=>{i.d(a,{k:()=>s});var n=i(51697);const t="rTMkDBDp47Eo12ZEQv4U";var l=i(4637);const s=({copyrights:e,courtesyLine:a})=>{const i=(e||[]).map(((e,a)=>{const i=e.text.replace(/^(\(C\)\s+)/,"").replace(/^(\(P\)\s+)/,"").replace(/^(©\s+)/,"").replace(/^(℗\s+)/,"");let t;return t="C"===e.type?"©":"P"===e.type?"℗":`(${e.type})`,(0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:`${t} ${i}`},a)}));return a&&i.unshift((0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:a},i.length)),(0,l.jsx)("div",{className:t,children:i})}}}]);
//# sourceMappingURL=xpui-routes-album.js.map