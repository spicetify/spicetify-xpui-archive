"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{54985:(e,a,i)=>{i.d(a,{g:()=>s});var n=i(51697),t=i(17237),l=i(4637);const s=({children:e})=>(0,l.jsx)(n.D,{variant:"mesto",className:t.Z.pretitle,children:e})},22456:(e,a,i)=>{i.d(a,{x:()=>m});var n=i(59496),t=i(33960),l=i(35960),s=i(7991),r=i(57678),o=i(39667),c=i(8591),d=i(4637);const m=({children:e,action:a,uri:i})=>{const m=(0,l.g)(),u=(0,r.j)();let g;const h=()=>{const e={triggerId:c.K,triggerAction:{type:a}};o.y.set((a=>({...a,...e}))),u.storeAction(s.wH,{operation:t.pT.ADD,uris:[i]})};try{g=n.Children.only(e)}catch(a){return(0,d.jsx)(d.Fragment,{children:e})}return m?n.cloneElement(g,{onClick:h}):(0,d.jsx)(d.Fragment,{children:e})}},31885:(e,a,i)=>{i.r(a),i.d(a,{default:()=>Le});var n=i(59496),t=i(84875),l=i.n(t),s=i(83792),r=i(97601),o=i(51697),c=i(88559),d=i(21054),m=i(9990),u=i(87508),g=i(30099),h=i(28489),k=i(26156),x=i(70304),p=i(7018),b=i(20456),j=i(29915),y=i(75132),v=i(68224),f=i(89723);const N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var S=i(72009);const C="iEG0moJ3mt1_j9Lho7MA";var F=i(4637);const I=({albumName:e,albumURI:a})=>{const{data:i}=(n={uri:a},t={cacheTime:5*f.y},(0,f.a)(N,n,t));var n,t;const l=i?.albumUnion&&"merch"in i.albumUnion?i?.albumUnion?.merch?.items:[];return l&&l?.length>0?(0,F.jsx)("div",{className:"contentSpacing",children:(0,F.jsx)("div",{className:C,children:(0,F.jsx)(S.s,{id:e,uri:a,merchItems:l,merchVariant:"Album page merch items"})})}):null};var U=i(23419),w=i(53851),A=i(40981),M=i(62768),T=i(4635),P=i(13138),L=i(24966),D=i(34046),O=i(62510),V=i(64689),z=i(46927),B=i(98440),R=i(99750),E=i(40006),q=i(22456),_=i(26473),H=i(18112),Q=i(7442),Z=i(34198),K=i(93019),G=i(47948),X=i(99550);const Y=n.memo((function({uri:e,togglePlay:a,isPlaying:i,isActive:t,spec:l,logger:s,backgroundColor:r,name:o,artists:c,isPlayable:d,sharingInfo:u}){const h=(0,H.o)(),x=(0,Q.k)(),p=(0,V.y)(),b=(0,n.useMemo)((()=>l.actionBarFactory()),[l]),[j,y]=(0,V.Z)(e),f=(0,n.useCallback)((()=>{const n=(0,Z.aK)({isPlaying:i,isActive:t,spec:b.playButtonFactory(),logger:s,uri:e});a({loggingParams:n})}),[i,t,a,b,s,e]),N=(0,n.useCallback)((async()=>{let a;const i=b.saveButtonFactory();a=j?i.hitDislike({itemToBeDisliked:e}):i.hitLike({itemToBeLiked:e}),s.logInteraction(a),h({targetUri:e,intent:j?"unsave":"save",type:"click"});try{await y(!j)}catch{}}),[h,e,j,y,b,s]),S=(0,m.W6)(G.eKc,{loadingValue:!1}),C=(0,_.j)();return(0,F.jsx)(z.o,{backgroundColor:r,children:(0,F.jsxs)(z.F,{children:[(0,F.jsx)(v.$,{onClick:f,disabled:!d,isPlaying:i,size:C,uri:e}),S&&(0,F.jsx)(D.Nh,{spec:b,children:(0,F.jsx)(X.K,{entityName:o,contextUri:e,activationPlacement:"bottomEnd",size:C})}),(0,F.jsx)(q.x,{uri:e,action:K.sr.SAVE_ALBUM,children:(0,F.jsx)(B.H,{isAdded:!!j,onClick:N,disabled:!x&&!p?.getCapabilities().canModifyOffline,size:C})}),(0,F.jsx)(R.o,{uri:e,isFollowing:!!j,onClick:(a,i)=>(0,Z.l7)(i,b.downloadButtonFactory(),s,e),onFollow:N,size:C}),(0,F.jsx)(A.ClickToggleContextMenu,{onShow:()=>(0,Z.qq)(b,s),menu:(0,F.jsx)(k.Y,{uri:e,artistUri:c?.[0]?.uri,sharingInfo:u}),children:(0,F.jsx)(E.MoreButton,{label:g.ag.get("more.label.context",o),size:C})})]})})}));var $=i(56946);const W=864e5,J=365.25*W;var ee=i(54985),ae=i(12463),ie=i(72951),ne=i(7554),te=i(6285),le=i(1541),se=i(20549),re=i(34997);const oe="TCmZzqInstJMZjkHgnw3",ce="PeNI572tTpqsN23o3QhJ",de="oUsSfFiifMPXqW0kHjR6",me="XKvEMQZlPfPncTqiitM5",ue="GdbPVlmUCW0Q6ZZ0z0wh",ge="Hu7O5y7x5c7wUYFbnIoS",he=n.memo((function(e){const{images:a,title:i,isOpen:t,onClose:l}=e,s=(0,n.useMemo)((()=>(0,re.X)(a,{desiredSize:1e4})),[a]);return s?(0,F.jsx)(le.Z,{className:oe,isOpen:t,onRequestClose:l,animation:{modal:{base:me,afterOpen:ue,beforeClose:ge}},animated:!0,children:(0,F.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:ce,children:[(0,F.jsx)(se.E,{loading:"eager",alt:i,src:s.url,className:de}),(0,F.jsx)(te.o,{onClick:l,semanticColor:"textBase",children:g.ag.get("web-player.cover-art-modal.close")})]})}):null}));var ke=i(65186),xe=i(14887),pe=i(74433),be=i(30477);const je=({releases:e})=>(0,F.jsx)(pe.v,{children:e.map((e=>(0,F.jsx)(be.s,{role:"menuitem",to:(0,xe.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))});var ye=i(47419),ve=i(11879),fe=i(915);const Ne="n8Bz0c0v17whD3KfMdOk",Se="zddjxV2lX9ukNM5QXloA",Ce="lVqlPjQLuQhK2flsxB78",Fe="O_EguRjsZ4uI1hHamkOA",Ie="jcaQQxoVnuuhtVwDJU1R",Ue="fLS8v3_EfBadEerbGVoR",we="in4OjUTflcsoj9RUpf05",Ae="_9KFlmOOpGkGHvRTBz2LX",Me=n.lazy((()=>i.e(4316).then(i.bind(i,54316))));function Te(e){switch(e){case ve.V.Single:return g.ag.get("single");case ve.V.Ep:return g.ag.get("ep");case ve.V.Compilation:return g.ag.get("compilation");case ve.V.Album:default:return g.ag.get("album")}}const Pe=({uri:e,album:a})=>{const i=(0,r.TH)(),{spec:t,logger:y,UBIFragment:f}=(0,D.fU)(u.w,{data:{uri:e}}),N=(0,n.useMemo)((()=>t.trackListFactory()),[t]),S=(0,n.useMemo)((()=>t.moreByArtistShelfFactory()),[t]),C=a.moreAlbumsByArtist,T=parseInt(new URLSearchParams((0,r.TH)().search).get("index")||"0",10),V=(0,U.Y)(e),{usePlayContextItem:z,togglePlay:B,isPlaying:R,isActive:E}=(0,P.n)({uri:V},{featureIdentifier:"album"}),q=(0,n.useCallback)(((e,a)=>{if(t){const e=t.headerFactory().artistNameFactory().hitUiNavigate({destination:a.creator.uri});y.logInteraction(e)}}),[y,t]),{isOpen:_,openModal:H,closeModal:Q}=(()=>{const[e,a]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>a(!0)),[]),closeModal:(0,n.useCallback)((()=>a(!1)),[])}})(),Z=(0,m.W6)(G.DUY,{loadingValue:!1})?{onClick:H,ariaLabel:g.ag.get("web-player.album.open_coverart_modal")}:{},K=(0,n.useCallback)((()=>new URLSearchParams(i.search.slice(1)).get("highlight")||""),[i.search]),X=a.uri,te=a.name,le=a.albumType,se=a.release?.date,re=a.nrTracks,oe=a.images,ce=a.extractedColors?.colorRaw.hex,de=a.artists,me=a.isPlayable,ue=a.isCatalogueRestricted,ge=a.copyright.items,xe=a.courtesyLine,pe=a.duration.durationMs,be=a.duration.isEstimate,ye=K(),ve=(0,s.v9)(ne.Gg),Pe=ve.overrides?.locale??g.ag.getLocale(),Le=(0,ie.k)({uri:e,type:"locale"}),De=(0,L.OT)({albumName:te,albumType:le,albumArtists:de.map((e=>e.name)).join(g.ag.getSeparator()),shouldLocalize:Le,i18n:g.ag});(0,w.Y5)(ce||null);const Oe=(0,ke.GA)(),Ve=function(e){return(0,n.useMemo)((()=>{if(!e?.date)return null;if("day"===e.precision){const a=new Date(e.date),i=(new Date).getTime()-a.getTime(),n=i%J;return n<3.5*W||n>312552e5?Math.round(i/J):null}return null}),[e])}(a.release);return(0,F.jsxs)("section",{className:Ne,"data-testid":"album-page",children:[(0,F.jsx)(x.$,{children:De}),null!==Ve?(0,F.jsx)(n.Suspense,{fallback:null,children:(0,F.jsx)(Me,{colorLight:a?.extractedColors?.colorLight.hex,colorDark:a?.extractedColors?.colorDark.hex,name:te,years:Ve})}):null,(0,F.jsxs)(p.gF,{backgroundColor:ce,children:[(0,F.jsxs)(b.W,{children:[(0,F.jsx)(v.$,{size:"medium",onClick:()=>B(),disabled:!me,isPlaying:R,uri:e}),(0,F.jsx)(j.i,{text:te,dragUri:e,dragLabel:te})]}),(0,F.jsx)(A._,{menu:(0,F.jsx)(k.Y,{uri:a.uri,artistUri:de?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,F.jsx)(p.Oz,{dragUri:X,images:oe,name:te,placeholderType:"album",...Z})}),(0,F.jsxs)(p.sP,{children:[(0,F.jsx)(ee.g,{children:Te(le)}),(0,F.jsx)(A._,{menu:(0,F.jsx)(k.Y,{uri:a.uri,artistUri:de?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,F.jsx)(p.xd,{dragUri:a.uri,dragLabel:a.name,scaleAtMinWidth:p.vz,children:te})}),(0,F.jsx)(p.QS,{creators:de,onCreatorClick:q,releaseDate:se,totalItems:re,durationMilliseconds:pe,isEstimatedDuration:be,hasTracks:!0})]})]}),(0,F.jsx)(Y,{backgroundColor:ce,uri:e,togglePlay:B,isPlaying:R,isActive:E,spec:t,logger:y,sharingInfo:a.sharingInfo,name:a.name,artists:a.artists,isPlayable:a.isPlayable}),ue?(0,F.jsxs)("div",{className:Se,children:[(0,F.jsx)(o.D,{as:"h2",variant:"cello",className:Ce,children:g.ag.get("windowed.product-album-header")}),(0,F.jsx)("div",{className:Fe,children:g.ag.get("windowed.product-album-description")})]}):null,(0,F.jsxs)("div",{className:"contentSpacing",children:[(0,F.jsx)(f,{spec:N,children:(0,F.jsx)($.L,{ariaLabel:te,nrTracks:(0,fe.y)(a.discs)?a.discs.totalCount+re:re,discs:a.discs,albumUri:X,highlightUri:ye,scrollToIndex:T,usePlayContextItem:z,initalTracks:a.items})}),(0,F.jsxs)("div",{className:we,children:[(0,F.jsxs)("div",{children:[se&&(0,F.jsx)(o.D,{as:"p",variant:"mesto",children:(0,O.BI)((0,O.RX)(se),Pe,{year:"numeric",month:"long",day:"numeric"})}),(0,F.jsx)(M.k,{copyrights:ge,courtesyLine:xe})]}),a.releases.items.length>0&&(0,F.jsx)(A.x,{menu:(0,F.jsx)(je,{releases:a.releases.items}),children:(e,i,n)=>(0,F.jsxs)("button",{ref:n,className:Ue,type:"button",onClick:i,children:[(0,F.jsx)(o.D,{variant:"mesto",children:g.ag.get("album-page.more-releases",a.releases.items.length)}),e?(0,F.jsx)(c.U,{iconSize:16}):(0,F.jsx)(d.i,{iconSize:16})]})})]})]}),(0,F.jsx)(I,{albumName:te,albumURI:X}),(0,F.jsx)(F.Fragment,{children:C?.length>0&&(0,F.jsx)("div",{className:"contentSpacing",children:(0,F.jsx)(f,{spec:S,children:(0,F.jsx)(ae.q,{index:0,id:"more-albums",className:Ie,title:g.ag.get("album-page.more-by-artist",de?.[0]?.name),total:C.length,seeAllUri:`${de?.[0]?.uri.replace("artist","app:artist")}:discography`,seeAllLabel:g.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:C.map(((e,a)=>(0,F.jsx)(h.i,{index:a,artists:de,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})})}),Oe&&(0,F.jsx)("div",{className:l()("contentSpacing",Ae),children:(0,F.jsx)(ke.qj,{title:g.ag.get("generative-ai.album.title")})}),(0,F.jsx)(he,{title:De,isOpen:_,onClose:Q,images:oe})]})},Le=n.memo((function(){const{albumId:e}=(0,r.UO)(),a=`spotify:album:${e}`,{loading:i,error:n,data:t,canLoadOffline:l}=(0,ye.j)(a);return i||!t?(0,F.jsx)(y.h,{hasError:null!==n,loadOffline:l,errorMessage:g.ag.get("error.not_found.title.album")}):(0,F.jsx)(T.fd,{surface:T.Tg.ALBUM,uris:[a],children:(0,F.jsx)(Pe,{uri:a,album:t})})}))}}]);
//# sourceMappingURL=xpui-routes-album.js.map