"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[9480],{1964:(e,t,a)=>{a.d(t,{M:()=>c});var i=a(59866),r=a(11862),o=a(22726),s=a(47805),l=a(34015);const n="Ws8Ec3GREpT5PAUesr9b",u="kHu_FTRgoBLSLeAJtyKY";var d=a(13274);const c=function({onClick:e,name:t,images:a,canEdit:c,placeholderType:m,shape:g=l.bg.SQUARE,dragUri:p=""}){const[h,f]=(0,r.P)(a),v=(0,o.b)(h,f)===o.g.loaded,{draggable:b,onDragStart:x}=(0,i.P)({itemUris:[p],dragLabelText:t});return(0,d.jsxs)("div",{className:n,"data-testid":`${m}-image`,draggable:b&&!!p,onDragStart:x,children:[(0,d.jsx)(l.bI,{loading:"eager",name:t,images:a,placeholderType:m,shape:g}),c&&(0,d.jsx)("div",{className:u,children:(0,d.jsx)(s.a,{overlay:v,onClick:e,rounded:g===l.bg.CIRCLE})})]})}},53779:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ea});var i=a(79474),r=a(61343),o=a(68087),s=a(48762),l=a(73189),n=a(37298),u=a(3348),d=a(12441),c=a(29432),m=a(30263),g=a(14428),p=a(13274);const h=e=>{const{uri:t}=e,{data:a,loading:i,error:r}=(0,g.Z)(m.SR,[t]),o=a?.profiles;return i?(0,p.jsx)(d.A,{hasError:null!==r,errorMessage:n.R.get("error.not_found.title.page")}):(0,p.jsx)(c.$,{className:"contentSpacing",title:n.R.get("followers"),total:o?.length,showAll:!0,fullPage:!0,rowGap:l.lT,children:o?.map(((e,t)=>(0,p.jsx)(u.a,{index:t,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))})},f=e=>{const{uri:t}=e,{data:a,loading:i,error:r}=(0,g.Z)(m.mH,[t]),o=a?.profiles;return i?(0,p.jsx)(d.A,{hasError:null!==r,errorMessage:n.R.get("error.not_found.title.page")}):(0,p.jsx)(c.$,{className:"contentSpacing",title:n.R.get("following"),total:o?.length,showAll:!0,fullPage:!0,rowGap:l.lT,children:o?.map(((e,t)=>(0,p.jsx)(u.a,{index:t,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))})};a(1137);var v=a(58703),b=a(97500),x=a.n(b),k=a(85980),y=a(42551),j=a(56260),R=a(31078),I=a(27582),_=a(29965),N=a(41627),w=a(33861),T=a(96590),A=a(1964),P=a(34015),C=a(94315),S=a(86597),E=a(43029),O=a(62725),U=a(83981),M=a(12793),L=a(48757),D=a(11862),F=a(22726);const H="F8_EX1AeKxXNSeh1qiHq",B="valcBm4lLe9qFBcg0sFY",W="tAIzXn8C9KriGwGuBfWg",J="PsrXxenHUFXYM1ub1xWw",$="U_VWfeeLWnDPhUTxCmrQ",G=function({onClickEdit:e,onClickRemove:t,name:a,images:i,canEdit:r}){const[o,s]=(0,D.P)(i),l=(0,F.b)(o,s)===F.g.loaded;return(0,p.jsxs)("div",{className:H,children:[(0,p.jsx)(P.bI,{loading:"eager",name:a,images:i,placeholderType:"user",shape:P.bg.CIRCLE}),r&&(0,p.jsxs)("div",{className:x()(B,{[J]:l}),children:[(0,p.jsx)("button",{className:W,"aria-haspopup":"true",onClick:e,type:"button",children:(0,p.jsx)(E.E,{variant:"bodyMedium",children:n.R.get("user.edit-details.choose-photo")})}),(0,p.jsx)("div",{className:x()($,"icon"),children:(0,p.jsx)(L.G,{size:"xlarge","aria-hidden":!0})}),(0,p.jsx)("button",{className:W,onClick:t,type:"button",children:(0,p.jsx)(E.E,{variant:"bodyMedium",children:n.R.get("user.edit-details.remove-photo")})})]})]})};var V=a(75212),K=a(85749),Q=a(59043);const z={paths:""},Z={encode(e,t=Q.Writer.create()){for(const a of e.paths)t.uint32(10).string(a);return t},decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...z};for(r.paths=[];a.pos<i;){const e=a.uint32();if(e>>>3==1)r.paths.push(a.string());else a.skipType(7&e)}return r},fromJSON(e){const t={...z};if(t.paths=[],void 0!==e.paths&&null!==e.paths)for(const a of e.paths)t.paths.push(String(a));return t},fromPartial(e){const t={...z};if(t.paths=[],void 0!==e.paths&&null!==e.paths)for(const a of e.paths)t.paths.push(a);return t},toJSON(e){const t={};return e.paths?t.paths=e.paths.map((e=>e)):t.paths=[],t}};a(34380);var q=a(21364),Y=a(84686).hp;const X={value:0},ee={value:!1},te={value:""};const ae={encode:(e,t=Q.Writer.create())=>(t.uint32(8).int32(e.value),t),decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...X};for(;a.pos<i;){const e=a.uint32();if(e>>>3==1)r.value=a.int32();else a.skipType(7&e)}return r},fromJSON(e){const t={...X};return void 0!==e.value&&null!==e.value?t.value=Number(e.value):t.value=0,t},fromPartial(e){const t={...X};return void 0!==e.value&&null!==e.value?t.value=e.value:t.value=0,t},toJSON(e){const t={};return void 0!==e.value&&(t.value=e.value),t}},ie={encode:(e,t=Q.Writer.create())=>(t.uint32(8).bool(e.value),t),decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...ee};for(;a.pos<i;){const e=a.uint32();if(e>>>3==1)r.value=a.bool();else a.skipType(7&e)}return r},fromJSON(e){const t={...ee};return void 0!==e.value&&null!==e.value?t.value=Boolean(e.value):t.value=!1,t},fromPartial(e){const t={...ee};return void 0!==e.value&&null!==e.value?t.value=e.value:t.value=!1,t},toJSON(e){const t={};return void 0!==e.value&&(t.value=e.value),t}},re={encode:(e,t=Q.Writer.create())=>(t.uint32(10).string(e.value),t),decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...te};for(;a.pos<i;){const e=a.uint32();if(e>>>3==1)r.value=a.string();else a.skipType(7&e)}return r},fromJSON(e){const t={...te};return void 0!==e.value&&null!==e.value?t.value=String(e.value):t.value="",t},fromPartial(e){const t={...te};return void 0!==e.value&&null!==e.value?t.value=e.value:t.value="",t},toJSON(e){const t={};return void 0!==e.value&&(t.value=e.value),t}};Q.util.Long!==q.A&&(Q.util.Long=q.A,(0,Q.configure)());const oe=globalThis;oe.atob,oe.btoa;const se={maxWidth:0,maxHeight:0,url:""},le={},ne={},ue={encode:(e,t=Q.Writer.create())=>(t.uint32(8).int32(e.maxWidth),t.uint32(16).int32(e.maxHeight),t.uint32(26).string(e.url),t),decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...se};for(;a.pos<i;){const e=a.uint32();switch(e>>>3){case 1:r.maxWidth=a.int32();break;case 2:r.maxHeight=a.int32();break;case 3:r.url=a.string();break;default:a.skipType(7&e)}}return r},fromJSON(e){const t={...se};return void 0!==e.maxWidth&&null!==e.maxWidth?t.maxWidth=Number(e.maxWidth):t.maxWidth=0,void 0!==e.maxHeight&&null!==e.maxHeight?t.maxHeight=Number(e.maxHeight):t.maxHeight=0,void 0!==e.url&&null!==e.url?t.url=String(e.url):t.url="",t},fromPartial(e){const t={...se};return void 0!==e.maxWidth&&null!==e.maxWidth?t.maxWidth=e.maxWidth:t.maxWidth=0,void 0!==e.maxHeight&&null!==e.maxHeight?t.maxHeight=e.maxHeight:t.maxHeight=0,void 0!==e.url&&null!==e.url?t.url=e.url:t.url="",t},toJSON(e){const t={};return void 0!==e.maxWidth&&(t.maxWidth=e.maxWidth),void 0!==e.maxHeight&&(t.maxHeight=e.maxHeight),void 0!==e.url&&(t.url=e.url),t}},de={encode(e,t=Q.Writer.create()){void 0!==e.username&&void 0!==e.username&&re.encode({value:e.username},t.uint32(10).fork()).ldelim(),void 0!==e.name&&void 0!==e.name&&re.encode({value:e.name},t.uint32(18).fork()).ldelim();for(const a of e.images)ue.encode(a,t.uint32(26).fork()).ldelim();return void 0!==e.verified&&void 0!==e.verified&&ie.encode({value:e.verified},t.uint32(34).fork()).ldelim(),void 0!==e.editProfileDisabled&&void 0!==e.editProfileDisabled&&ie.encode({value:e.editProfileDisabled},t.uint32(42).fork()).ldelim(),void 0!==e.reportAbuseDisabled&&void 0!==e.reportAbuseDisabled&&ie.encode({value:e.reportAbuseDisabled},t.uint32(50).fork()).ldelim(),void 0!==e.abuseReportedName&&void 0!==e.abuseReportedName&&ie.encode({value:e.abuseReportedName},t.uint32(58).fork()).ldelim(),void 0!==e.abuseReportedImage&&void 0!==e.abuseReportedImage&&ie.encode({value:e.abuseReportedImage},t.uint32(66).fork()).ldelim(),void 0!==e.hasSpotifyName&&void 0!==e.hasSpotifyName&&ie.encode({value:e.hasSpotifyName},t.uint32(74).fork()).ldelim(),void 0!==e.hasSpotifyImage&&void 0!==e.hasSpotifyImage&&ie.encode({value:e.hasSpotifyImage},t.uint32(82).fork()).ldelim(),void 0!==e.color&&void 0!==e.color&&ae.encode({value:e.color},t.uint32(90).fork()).ldelim(),t},decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...le};for(r.images=[];a.pos<i;){const e=a.uint32();switch(e>>>3){case 1:r.username=re.decode(a,a.uint32()).value;break;case 2:r.name=re.decode(a,a.uint32()).value;break;case 3:r.images.push(ue.decode(a,a.uint32()));break;case 4:r.verified=ie.decode(a,a.uint32()).value;break;case 5:r.editProfileDisabled=ie.decode(a,a.uint32()).value;break;case 6:r.reportAbuseDisabled=ie.decode(a,a.uint32()).value;break;case 7:r.abuseReportedName=ie.decode(a,a.uint32()).value;break;case 8:r.abuseReportedImage=ie.decode(a,a.uint32()).value;break;case 9:r.hasSpotifyName=ie.decode(a,a.uint32()).value;break;case 10:r.hasSpotifyImage=ie.decode(a,a.uint32()).value;break;case 11:r.color=ae.decode(a,a.uint32()).value;break;default:a.skipType(7&e)}}return r},fromJSON(e){const t={...le};if(t.images=[],void 0!==e.username&&null!==e.username?t.username=String(e.username):t.username=void 0,void 0!==e.name&&null!==e.name?t.name=String(e.name):t.name=void 0,void 0!==e.images&&null!==e.images)for(const a of e.images)t.images.push(ue.fromJSON(a));return void 0!==e.verified&&null!==e.verified?t.verified=Boolean(e.verified):t.verified=void 0,void 0!==e.editProfileDisabled&&null!==e.editProfileDisabled?t.editProfileDisabled=Boolean(e.editProfileDisabled):t.editProfileDisabled=void 0,void 0!==e.reportAbuseDisabled&&null!==e.reportAbuseDisabled?t.reportAbuseDisabled=Boolean(e.reportAbuseDisabled):t.reportAbuseDisabled=void 0,void 0!==e.abuseReportedName&&null!==e.abuseReportedName?t.abuseReportedName=Boolean(e.abuseReportedName):t.abuseReportedName=void 0,void 0!==e.abuseReportedImage&&null!==e.abuseReportedImage?t.abuseReportedImage=Boolean(e.abuseReportedImage):t.abuseReportedImage=void 0,void 0!==e.hasSpotifyName&&null!==e.hasSpotifyName?t.hasSpotifyName=Boolean(e.hasSpotifyName):t.hasSpotifyName=void 0,void 0!==e.hasSpotifyImage&&null!==e.hasSpotifyImage?t.hasSpotifyImage=Boolean(e.hasSpotifyImage):t.hasSpotifyImage=void 0,void 0!==e.color&&null!==e.color?t.color=Number(e.color):t.color=void 0,t},fromPartial(e){const t={...le};if(t.images=[],void 0!==e.username&&null!==e.username?t.username=e.username:t.username=void 0,void 0!==e.name&&null!==e.name?t.name=e.name:t.name=void 0,void 0!==e.images&&null!==e.images)for(const a of e.images)t.images.push(ue.fromPartial(a));return void 0!==e.verified&&null!==e.verified?t.verified=e.verified:t.verified=void 0,void 0!==e.editProfileDisabled&&null!==e.editProfileDisabled?t.editProfileDisabled=e.editProfileDisabled:t.editProfileDisabled=void 0,void 0!==e.reportAbuseDisabled&&null!==e.reportAbuseDisabled?t.reportAbuseDisabled=e.reportAbuseDisabled:t.reportAbuseDisabled=void 0,void 0!==e.abuseReportedName&&null!==e.abuseReportedName?t.abuseReportedName=e.abuseReportedName:t.abuseReportedName=void 0,void 0!==e.abuseReportedImage&&null!==e.abuseReportedImage?t.abuseReportedImage=e.abuseReportedImage:t.abuseReportedImage=void 0,void 0!==e.hasSpotifyName&&null!==e.hasSpotifyName?t.hasSpotifyName=e.hasSpotifyName:t.hasSpotifyName=void 0,void 0!==e.hasSpotifyImage&&null!==e.hasSpotifyImage?t.hasSpotifyImage=e.hasSpotifyImage:t.hasSpotifyImage=void 0,void 0!==e.color&&null!==e.color?t.color=e.color:t.color=void 0,t},toJSON(e){const t={};return void 0!==e.username&&(t.username=e.username),void 0!==e.name&&(t.name=e.name),e.images?t.images=e.images.map((e=>e?ue.toJSON(e):void 0)):t.images=[],void 0!==e.verified&&(t.verified=e.verified),void 0!==e.editProfileDisabled&&(t.editProfileDisabled=e.editProfileDisabled),void 0!==e.reportAbuseDisabled&&(t.reportAbuseDisabled=e.reportAbuseDisabled),void 0!==e.abuseReportedName&&(t.abuseReportedName=e.abuseReportedName),void 0!==e.abuseReportedImage&&(t.abuseReportedImage=e.abuseReportedImage),void 0!==e.hasSpotifyName&&(t.hasSpotifyName=e.hasSpotifyName),void 0!==e.hasSpotifyImage&&(t.hasSpotifyImage=e.hasSpotifyImage),void 0!==e.color&&(t.color=e.color),t}},ce={encode:(e,t=Q.Writer.create())=>(void 0!==e.mask&&void 0!==e.mask&&Z.encode(e.mask,t.uint32(10).fork()).ldelim(),void 0!==e.userProfile&&void 0!==e.userProfile&&de.encode(e.userProfile,t.uint32(18).fork()).ldelim(),t),decode(e,t){const a=e instanceof Uint8Array?new Q.Reader(e):e;let i=void 0===t?a.len:a.pos+t;const r={...ne};for(;a.pos<i;){const e=a.uint32();switch(e>>>3){case 1:r.mask=Z.decode(a,a.uint32());break;case 2:r.userProfile=de.decode(a,a.uint32());break;default:a.skipType(7&e)}}return r},fromJSON(e){const t={...ne};return void 0!==e.mask&&null!==e.mask?t.mask=Z.fromJSON(e.mask):t.mask=void 0,void 0!==e.userProfile&&null!==e.userProfile?t.userProfile=de.fromJSON(e.userProfile):t.userProfile=void 0,t},fromPartial(e){const t={...ne};return void 0!==e.mask&&null!==e.mask?t.mask=Z.fromPartial(e.mask):t.mask=void 0,void 0!==e.userProfile&&null!==e.userProfile?t.userProfile=de.fromPartial(e.userProfile):t.userProfile=void 0,t},toJSON(e){const t={};return void 0!==e.mask&&(t.mask=e.mask?Z.toJSON(e.mask):void 0),void 0!==e.userProfile&&(t.userProfile=e.userProfile?de.toJSON(e.userProfile):void 0),t}},me=`${V.I_}/identity`;async function ge(e,t,{name:a,imageUploadToken:i}){void 0!==a&&await async function(e,t,a){const i=ce.encode(ce.fromPartial({mask:{paths:["name"]},userProfile:null!==a?{name:a}:{}}));await e.build().withHost(me).withMethod("POST").withPath(`/v3/user/username/${encodeURIComponent((0,K.v)(t))}`).withEndpointIdentifier("/v3/user/username/{username}").withBody(i.finish()).withoutMarket().send()}(e,t,a),void 0!==i&&(null!==i?await async function(e,t,a){await e.build().withHost(me).withMethod("POST").withPath(`/v3/profile-image/${encodeURIComponent((0,K.v)(t))}/${a}`).withEndpointIdentifier("/v3/profile-image/{username}/{uploadToken}").withoutMarket().send()}(e,t,i):await async function(e,t){await e.build().withHost(me).withMethod("DELETE").withPath(`/v3/profile-image/${encodeURIComponent((0,K.v)(t))}`).withEndpointIdentifier("/v3/profile-image/{username}").withoutMarket().send()}(e,t))}var pe=a(93129);const he={type:"error",get message(){return n.R.get("user.edit-details.error.file-size-exceeded",10)}},fe={type:"error",get message(){return n.R.get("user.edit-details.error.too-small",300,300)}},ve={type:"error",get message(){return n.R.get("user.edit-details.error.missing-name")}},be={type:"error",get message(){return n.R.get("user.edit-details.error.failed-to-save")}},xe={type:"error",get message(){return n.R.get("user.edit-details.error.file-upload-failed")}};function ke(e){return{type:"setLoading",loading:e}}function ye(e){return{type:"setMessage",message:e}}function je(e,t){switch(t.type){case"setName":return{...e,name:t.name};case"setMessage":return{...e,message:t.message,loading:!1};case"setLoading":return{...e,loading:t.loading,message:null};case"setImageData":return{...e,imageData:t.data,removeImage:!1};case"setImageToken":return{...e,imageToken:t.token,removeImage:!1};case"removeImage":return{...e,imageToken:void 0,imageData:void 0,image:void 0,removeImage:!0};default:return e}}var Re=a(65474),Ie=a(21617),_e=a(84777);const Ne="XwNfIrI6_hCa_9_T2cQB",we="so0bdX3oZH6YW5_nGxIR",Te="aM3plU4zzDqjWlvUHGYb",Ae="zHeo4VUxytwm6Ptr0QyA",Pe="vAeyAmeLkDEDKdL9Hou0",Ce="dnmzO6yYKkxUV8jl7O1Z",Se="oN9QVvJKEtdTH3HGfCu1",Ee="uj7hczcCH1dZpse8Kfmi",Oe="wvLAEV5wF5C5ej6rvimT",Ue="gAQfzAUp1FuSXODeZJfP",Me="dMhJaxli87_22jb_3d9x",Le="MDb7QhAtHeyM4gKj8j8t",De="zGbjZMZ1DTx4futEbN9l",Fe=i.memo((function({uri:e,name:t,image:a,onClose:r,shouldOpenImagePicker:o,userCapabilities:s}){const[l,u]=(0,Ie.p$)(),[d,c]=function({name:e,image:t}){return(0,i.useReducer)(je,{loading:!1,message:null,name:e,image:t})}({name:t,image:a}),m=(0,i.useMemo)((()=>{const e=d.imageData||d.image;return e?[{url:e,width:300,height:300}]:[]}),[d.image,d.imageData]);(0,i.useEffect)((()=>{o&&u()}),[u,o]);const g=(0,i.useCallback)((e=>{e===Ie.il.FILE_TOO_BIG?c(ye(he)):e===Ie.il.IMAGE_TOO_SMALL&&c(ye(fe))}),[c]),h=(0,i.useCallback)((()=>{c({type:"removeImage"})}),[c]),f=(0,i.useCallback)((async t=>{t.preventDefault();if(0!==d.name.trim().length){c(ke(!0));try{const t=d.removeImage?null:d.imageToken;await async function(e,{name:t,imageUploadToken:a}){await ge(pe.n.getInstance(),e,{name:t,imageUploadToken:a})}(e,{name:d.name,imageUploadToken:t}),r({name:d.name,image:d.imageData||d.image})}catch(e){c(ye(be))}}else c(ye(ve))}),[c,r,d.image,d.imageData,d.imageToken,d.name,d.removeImage,e]);return(0,p.jsx)(Re.A,{isOpen:!0,contentLabel:n.R.get("user.edit-details.title"),onRequestClose:()=>r(),children:(0,p.jsxs)("div",{className:Ne,children:[(0,p.jsxs)("div",{className:Te,children:[(0,p.jsx)(E.E,{as:"h1",variant:"titleSmall",children:n.R.get("user.edit-details.title")}),(0,p.jsx)("button",{className:Ae,onClick:()=>r(),"aria-label":n.R.get("close"),children:(0,p.jsx)(O.M,{size:"small"})})]}),d.message&&(0,p.jsx)(_e.z,{isErrorMessage:"error"===d.message.type,message:d.message.message}),(0,p.jsxs)("form",{className:we,onSubmit:f,children:[s.edit_image&&(0,p.jsx)(Ie.uU,{isOpen:l,minImageWidth:300,minImageHeight:300,maxFileSizeMB:10,onChange:async function(e){if(!e)return;const{imageFile:t,imageDataUrl:a}=e;if(c(ye(null)),c({type:"setImageData",data:a}),t)try{c(ke(!0));const e=await async function(e){const t=await pe.n.getInstance().build().withEndpointIdentifier("image-upload/v4/user-profile").withHost("https://image-upload.spotify.com/v4").withMethod("POST").withPath("/user-profile").withBody(e).withoutGlobalHeaders().withHeaders([{key:"Content-Type",value:"image/jpeg"}]).withoutMarket().send();if(!t.body)throw new Error("No upload token recieved");return t.body.uploadToken}(t);c({type:"setImageToken",token:e}),c(ke(!1))}catch{c(ye(xe))}},onError:g}),(0,p.jsxs)("div",{className:Pe,children:[(0,p.jsx)(G,{name:t,images:m,onClickEdit:u,onClickRemove:h,canEdit:s.edit_image}),d.loading&&(0,p.jsx)("div",{className:Ce,children:(0,p.jsx)(U.I,{})})]}),(0,p.jsxs)("div",{className:Ee,children:[(0,p.jsx)("label",{htmlFor:"user-edit-name",className:Oe,children:(0,p.jsx)(E.E,{variant:"marginalBold",className:Ue,children:n.R.get("user.edit-details.name-label")})}),(0,p.jsx)("input",{"data-testid":"user-edit-name-input",id:"user-edit-name",type:"text",dir:"auto",className:x()(Se,Me),onChange:e=>{c(function(e){return{type:"setName",name:e}}(e.target.value))},placeholder:n.R.get("user.edit-details.name-placeholder"),maxLength:32,value:d.name,disabled:!s.edit_name})]}),(0,p.jsx)("div",{className:Le,children:(0,p.jsx)(M.$,{colorSet:"invertedLight",onClick:f,disabled:d.loading,children:n.R.get("save")})}),(0,p.jsx)(E.E,{as:"p",variant:"marginalBold",className:De,children:n.R.get("image-upload.legal-disclaimer")})]})]})})}));var He=a(3106),Be=a(4122),We=a(5838),Je=a(41251),$e=a(86279),Ge=a(90331),Ve=a(49882),Ke=a(15486),Qe=a(466),ze=a(68197),Ze=a(33032),qe=a(98805),Ye=a(68274),Xe=a(30405),et=a(65948),tt=a(2346),at=a(13606),it=a(20533),rt=a(63441),ot=a(43608);const st=i.memo((function({openModal:e,spec:t,logger:a,name:r,backgroundColor:o,isCurrentUser:s,uri:l}){const[u,d]=(0,at.Y)(l),c=(0,et.W)(),m=!(0,tt.n)(),g=(0,i.useCallback)((()=>{c({targetUri:l,intent:u?"unfollow":"follow",type:"click"});const e=t.actionBarFactory().followButtonFactory();u?(d(!1),a.logInteraction(e.hitUnfollow({itemToBeUnfollowed:l}))):(d(!0),a.logInteraction(e.hitFollow({itemToBeFollowed:l})))}),[u,a,c,d,t,l]),h=(0,i.useCallback)((()=>{const e=t.actionBarFactory().contextMenuButtonFactory().hitUiReveal();a.logInteraction(e)}),[a,t]),f=(0,ot.j)();return(0,p.jsx)(it.E,{backgroundColor:o,children:(0,p.jsxs)(rt.S,{children:[!s&&(0,p.jsx)(Ye.e,{children:(0,p.jsx)(Xe.W,{isFollowing:Boolean(u),onClick:g,disabled:m})}),(0,p.jsx)(qe.b,{menu:(0,p.jsx)(w.B,{uri:l,onEditProfileCallback:e}),children:(0,p.jsx)(Ze.e,{label:n.R.get("more.label.context",r),onClick:h,size:f})})]})})}));var lt=a(6018),nt=a(39974),ut=a(51773),dt=a(11148),ct=a(56291),mt=a(65553),gt=a(39431),pt=a(13031),ht=a(34092),ft=a(23e3);const vt=i.memo((function({tracks:e,hasHeaderRow:t=!1,nrTracksVisible:a,uri:r}){const o=(0,K.v)(r),l=(0,s.du)(o,"tracks").toURI(),u=(0,i.useMemo)((()=>a?e.slice(0,a):e),[a,e]),{usePlayContextItem:d}=(0,pt.P)({uri:l,pages:[{items:e.map((e=>({type:ft.c.TRACK,uri:e.uri,uid:null,provider:null})))}]},{featureIdentifier:"profile",referrerIdentifier:"user_profile"}),c=(0,i.useCallback)(((e,t)=>{const a=(0,Qe.g)(e?.albumOfTrack?.coverArt?.sources,{desiredSize:40});return(0,p.jsx)(dt.MJ,{index:t,uri:(0,mt.a)(e),duration_ms:e.duration.totalMilliseconds,name:e.name,artists:e.artists.items.map((({uri:e,profile:{name:t}})=>({uri:e,name:t}))),album:e.albumOfTrack,isPlayable:!0,isExplicit:e.contentRating?.label===ht.x7.Explicit,isMOGEFRestricted:e.contentRating?.label===ht.x7.NineteenPlus,imgUrl:a?.url||"",contextUri:l,usePlayContextItem:d},t+e.uri)}),[l,d]),m=(0,i.useMemo)((()=>[ut.$C.INDEX,ut.$C.TITLE_AND_ARTIST,ut.$C.ALBUM,ut.$C.DURATION]),[]),g=(0,i.useCallback)((e=>({uri:e.uri})),[]),h=(0,ct.A)()?0:void 0;return(0,p.jsx)(gt.pZ,{value:"user-top-tracks-tracklist",children:(0,p.jsx)(ut.S4,{ariaLabel:n.R.get("top_tracks_this_month"),renderRow:c,nrTracks:u.length,tracks:u,resolveItem:g,headerTop:h,hasHeaderRow:t,columns:m,columnPersistenceKey:"user-top-tracks-tracklist"})})}),((e,t)=>e.tracks===t.tracks)),bt=i.memo((function({tracks:e,title:t,tagline:a,seeAllUri:r,className:o,uri:s,spec:l}){const n=(0,nt.s)(),u=(0,i.useCallback)((()=>{const e=l.titleLinkFactory().hitUiNavigate({destination:r});n.logInteraction(e)}),[n,r,l]),d=(0,i.useCallback)((()=>{const e=l.titleLinkFactory().hitUiNavigate({destination:r});n.logInteraction(e)}),[n,r,l]);if(!e||0===e.totalCount||0===e.items.length)return null;const c=e.totalCount>4;return(0,p.jsxs)("section",{className:o,children:[(0,p.jsx)(lt.U,{title:t,tagline:a,seeAllUri:r,hasMoreElements:c,onClickTitle:u,onClickSeeAll:d}),(0,p.jsx)(Ve.r,{spec:l,children:(0,p.jsx)(vt,{tracks:e.items,uri:s,nrTracksVisible:4})})]})}),((e,t)=>e.tracks===t.tracks));function xt(e,t){switch(t.type){case"OPEN_MODAL":return{isModalOpen:!0,modalVariant:"editProfile",shouldOpenImagePicker:!1};case"OPEN_MODAL_WITH_IMAGEPICKER":return{isModalOpen:!0,modalVariant:"editProfile",shouldOpenImagePicker:!0};case"CLOSE_MODAL":return{isModalOpen:!1,modalVariant:null,shouldOpenImagePicker:!1};default:return e}}var kt=a(34719),yt=a(66031),jt=a(154),Rt=a(59734),It=a(52809),_t=a(67007),Nt=a(73534),wt=(a(62355),a(48117),a(82871)),Tt=a(17094);const At=new wt.l("userTopContent","query","feb6d55177e2cbce2ac59214f9493f1ef2e4368eec01b3d4c3468fa1b97336e2",null);function Pt(e){return"Artist"===e.__typename}function Ct(e){if("ArtistPageV2"!==e?.topArtists?.__typename)return null;const t=e.topArtists.items.map((e=>e.data)).filter(Pt);return 0===t.length?null:{totalCount:e.topArtists.totalCount,items:t}}function St(e){return"Track"===e.__typename}function Et(e){if("TrackPageV2"!==e?.topTracks?.__typename)return null;const t=e.topTracks.items.map((e=>e.data)).filter(St).filter((e=>null!==e.albumOfTrack));return 0===t.length?null:{totalCount:e.topTracks.totalCount,items:t}}const Ot=ht.xE.Affinity,Ut=ht.Nm.ShortTerm;function Mt({includeTopArtists:e,includeTopTracks:t,topArtistsLimit:a,topTracksLimit:i}){const{data:r,loading:o,error:s}=(l={includeTopArtists:e,topArtistsInput:{offset:0,limit:a,sortBy:Ot,timeRange:Ut},includeTopTracks:t,topTracksInput:{offset:0,limit:i,sortBy:Ot,timeRange:Ut}},n={enabled:e||t,gcTime:18e5,staleTime:3e5},(0,Tt.I)(At,l,n));var l,n;return null!==s?{topTracks:null,topArtists:null,loading:o,error:new Error("Failed loading user top content!")}:{topTracks:Et(r?.me?.profile??null),topArtists:Ct(r?.me?.profile??null),loading:o,error:null}}const Lt="umiKMm5NVr5UeBJCHS6U",Dt="jzhwZKbfx4vrC_MYd_7c",Ft="kWCnF32FrVtGHmTy8QeV",Ht="uJxNEI2k7x8UCDdMKELt",Bt="wDIZ2yYKjfGI68I4cZ98",Wt=18e5,Jt=3e5,$t=(0,y.Mz)(We.mB,(e=>e?.images||[])),Gt=({uri:e,isCurrentUser:t})=>{const a=(0,k.d4)(We.mB)?.uri,r=(0,k.d4)(We.Mn),o=(0,k.d4)($t),l=(0,k.wA)(),c=(0,v.jE)(),h=(0,j.NC)(Nt.DGB,{loadingValue:!0}),f=(0,i.useMemo)((()=>(0,Qe.g)(o)),[o]),[{isModalOpen:b,modalVariant:y,shouldOpenImagePicker:E},O]=function(){const[e,t]=(0,i.useReducer)(xt,{isModalOpen:!1,modalVariant:null,shouldOpenImagePicker:!1});return[e,t]}(),{data:U,loading:M,queryKey:L}=(0,g.Z)(m.E$,[{uri:e,playlists:10,artists:10,episodes:10}],{gcTime:Wt,staleTime:Jt}),D=(0,He.V)();(0,_t.N)(It.mc.OPERATION_COMPLETE,(()=>{c.invalidateQueries({queryKey:L})})),(0,Ge.l)($e.UV.OPERATION_COMPLETE,(()=>{c.invalidateQueries({queryKey:L})}));const F=U?.public_playlists,H=U?.is_verified,B=U?.recently_played_artists,W=t?f?.url||"":U?.image_url||"",J=(0,K.v)(e),$=(t?r:U?.name)||"",G=(0,Be.H)(U?.image_url||null),{spec:V,logger:Q}=(0,Ke.r)(R._,{data:{uri:e}}),z=(0,i.useMemo)((()=>V.sectionTopTracksFactory()),[V]),Z=!D&&(!1!==U?.show_follows||t),q=t&&h,{data:Y,loading:X}=(0,g.Z)(m.mH,[e],{enabled:Z,gcTime:Wt,staleTime:Jt}),ee=Y?.profiles,{data:te,loading:ae}=(0,g.Z)(m.SR,[e],{enabled:Z,gcTime:Wt,staleTime:Jt}),ie=te?.profiles,re=ee?.some((e=>e.uri===a)),{topArtists:oe,topTracks:se,loading:le}=Mt({includeTopArtists:q,includeTopTracks:q,topArtistsLimit:10,topTracksLimit:4}),ne=(0,i.useCallback)((e=>{O({type:"CLOSE_MODAL"}),e&&(l((0,Je.IE)(e.name)),l((0,Je.ZQ)(e.image?[{url:e.image,height:null,width:null}]:[])))}),[O,l]),ue=(0,i.useCallback)((()=>{O({type:"OPEN_MODAL"});const e=V.headerFactory().usernameFactory().hitUiReveal();Q.logInteraction(e)}),[Q,O,V]),de=(0,i.useCallback)((()=>{O({type:"OPEN_MODAL_WITH_IMAGEPICKER"});const e=V.headerFactory().profileImageFactory().hitUiReveal();Q.logInteraction(e)}),[Q,O,V]),ce=(0,i.useMemo)((()=>[{url:W}]),[W]),me=(0,i.useCallback)((()=>{const e=V.headerFactory().usernameFactory().hitUiReveal();Q.logInteraction(e)}),[Q,V]),ge=(0,i.useCallback)(((e,t)=>{if(!t)return;const a=V.headerFactory().followersLinkFactory().hitUiNavigate({destination:t});Q.logInteraction(a)}),[Q,V]),pe=(0,i.useCallback)(((e,t)=>{if(!t)return;const a=V.headerFactory().followersLinkFactory().hitUiNavigate({destination:t});Q.logInteraction(a)}),[Q,V]);if(!U||M||X||ae||le)return(0,p.jsx)(d.A,{hasError:!1,errorMessage:n.R.get("error.not_found.title.page")});const he=x()("contentSpacing",Dt),fe=Z&&!!ie?.length,ve=Z&&!!ee?.length;return(0,p.jsxs)("div",{className:Lt,children:[(0,p.jsx)(T.Q,{children:$}),(0,p.jsxs)(P.z4,{backgroundColor:G,children:[(0,p.jsx)(C.h,{children:(0,p.jsx)(S.X,{text:$})}),(0,p.jsx)(N.h,{menu:(0,p.jsx)(w.B,{uri:U.uri}),children:(0,p.jsx)(kt.X,{children:(0,p.jsx)(A.M,{canEdit:t&&!U.edit_image_disabled,name:$,images:ce,onClick:de,placeholderType:"user",shape:P.bg.CIRCLE})})}),(0,p.jsxs)(P.Y$,{children:[(0,p.jsx)(yt.B,{children:H?(0,p.jsx)(jt.M,{text:n.R.get("card.tag.profile")}):n.R.get("card.tag.profile")}),(0,p.jsx)(N.h,{menu:(0,p.jsx)(w.B,{uri:U.uri}),children:(0,p.jsx)(P.mm,{canEdit:t&&!U.edit_name_disabled,editTitle:n.R.get("playlist.edit-details.title"),onClick:ue,children:$})}),(0,p.jsx)(P.tV,{totalFollowers:U.followers_count,totalFollowing:U.following_count,publicPlaylists:U.total_public_playlists_count,userUri:e,onCreatorClick:me,onTotalFollowersClick:ge,onTotalFollowingClick:pe,theyFollowUs:re})]})]}),(0,p.jsx)(st,{openModal:ue,spec:V,logger:Q,name:$,backgroundColor:G,isCurrentUser:t,uri:e}),(0,p.jsxs)(Ve.r,{spec:V,children:[t&&(0,p.jsxs)(p.Fragment,{children:[null!==oe&&(0,p.jsx)(Rt.p,{className:he,total:oe.totalCount,title:n.R.get("top_artists_this_month"),tagline:n.R.get("only_visible_to_you"),seeAllUri:(0,s.Qj)(J,["top","artists"]).toURI(),id:"top-artists",index:0,children:oe.items.map(((e,t)=>(0,p.jsx)(I.a,{index:t,uri:e.uri,name:e.profile.name,images:e.visuals.avatarImage?.sources??[]},e.uri)))}),(0,p.jsx)(bt,{className:he,title:n.R.get("top_tracks_this_month"),tagline:n.R.get("only_visible_to_you"),seeAllUri:(0,s.Qj)(J,["top","tracks"]).toURI(),uri:e,tracks:se,spec:z})]}),(0,p.jsx)(Rt.p,{className:he,total:U.total_public_playlists_count,title:n.R.get("public_playlists"),seeAllUri:(0,s.Qj)(J,["playlists"]).toURI(),id:"playlists",index:1,children:F?.map(((e,t)=>(0,p.jsx)(_.B,{index:t,uri:e.uri,name:e.name,images:[{url:(0,ze.m)({imageUriOrUrl:e.image_url}),width:300,height:300}],authorName:e.owner_name,description:e.followers_count?n.R.get("user.followers",e.followers_count):""},e.uri)))}),B?.length?(0,p.jsx)(Rt.p,{className:he,total:B?.length,title:n.R.get("recently_played_artists"),seeAllUri:(0,s.Qj)(J,["recently-played-artists"]).toURI(),id:"recently-played-artists",index:2,children:B?.map(((e,t)=>(0,p.jsx)(I.a,{index:t,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,fe?(0,p.jsx)(Rt.p,{className:he,title:n.R.get("followers"),total:ie?.length,seeAllUri:(0,s.Qj)(J,["followers"]).toURI(),id:"followers",index:3,children:ie?.map(((e,t)=>(0,p.jsx)(u.a,{index:t,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,ve?(0,p.jsx)(Rt.p,{className:he,title:n.R.get("following"),total:ee?.length,seeAllUri:(0,s.Qj)(J,["following"]).toURI(),id:"following",index:4,children:ee?.map(((e,t)=>(0,p.jsx)(u.a,{index:t,uri:e.uri,name:e.name,images:[{url:e.image_url}]},e.uri)))}):null,t&&b&&("editProfile"===y?(0,p.jsx)(Fe,{uri:e,name:$,image:W,onClose:ne,shouldOpenImagePicker:E,userCapabilities:{edit_image:!U?.edit_image_disabled,edit_name:!U?.edit_name_disabled}}):null)]})]})},Vt=e=>{const{uri:t}=e,{data:a,loading:i,error:r}=(0,g.Z)(m.Eo,[{uri:t}]),{public_playlists:o,total_public_playlists_count:s=0}=a||{};return i?(0,p.jsx)(d.A,{hasError:null!==r,errorMessage:n.R.get("error.not_found.title.page")}):(0,p.jsx)(c.$,{className:"contentSpacing",total:s,title:n.R.get("public_playlists"),showAll:!0,fullPage:!0,rowGap:l.lT,children:o?.map(((e,t)=>(0,p.jsx)(_.B,{index:t,uri:e.uri,name:e.name,authorName:e.owner_name,description:e.followers_count?n.R.get("user.followers",e.followers_count):"",images:[{url:(0,ze.m)({imageUriOrUrl:e.image_url}),width:300,height:300}]},e.uri)))})},Kt=e=>{const{uri:t}=e,{data:a,loading:i,error:r}=(0,g.Z)(m.sL,[{uri:t,limit:50}]),o=a?.artists;return i?(0,p.jsx)(d.A,{hasError:null!==r,errorMessage:n.R.get("error.not_found.title.page")}):(0,p.jsx)(c.$,{className:"contentSpacing",total:o?.length,title:n.R.get("recently_played_artists"),showAll:!0,fullPage:!0,rowGap:l.lT,children:o?.map(((e,t)=>(0,p.jsx)(I.a,{index:t,name:e.name,uri:e.uri,images:[{url:e.image_url}]},e.uri)))})},Qt=()=>{const{topArtists:e,loading:t,error:a}=Mt({includeTopArtists:!0,includeTopTracks:!1,topArtistsLimit:100,topTracksLimit:0});return t?(0,p.jsx)(d.A,{hasError:null!==a,errorMessage:n.R.get("error.not_found.title.page")}):null===e?null:(0,p.jsx)(c.$,{className:"contentSpacing",total:e.items.length,title:n.R.get("top_artists_this_month"),tagline:n.R.get("only_visible_to_you"),showAll:!0,fullPage:!0,rowGap:l.lT,children:e.items.map(((e,t)=>(0,p.jsx)(I.a,{index:t,uri:e.uri,name:e.profile.name,images:e.visuals.avatarImage?.sources??[]},e.uri)))})},zt=({isCurrentUser:e})=>e?(0,p.jsx)(Qt,{}):(0,p.jsx)(d.A,{hasError:!0,errorMessage:n.R.get("error.not_found.title.page")}),Zt=({uri:e})=>{const{topTracks:t,loading:a,error:i}=Mt({includeTopArtists:!1,includeTopTracks:!0,topArtistsLimit:0,topTracksLimit:100});return a?(0,p.jsx)(d.A,{hasError:null!==i,errorMessage:n.R.get("error.not_found.title.page")}):null===t?null:(0,p.jsxs)("div",{className:x()("contentSpacing",Ft),children:[(0,p.jsxs)("div",{className:Ht,children:[(0,p.jsx)(E.E,{as:"h1",variant:"titleMedium",className:Bt,children:n.R.get("top_tracks_this_month")}),(0,p.jsx)(E.E,{as:"p",variant:"bodySmall",children:n.R.get("only_visible_to_you")})]}),(0,p.jsx)(vt,{tracks:t.items,uri:e,hasHeaderRow:!0})]})},qt=({uri:e,isCurrentUser:t})=>t?(0,p.jsx)(Zt,{uri:e}):(0,p.jsx)(d.A,{hasError:!0,errorMessage:n.R.get("error.not_found.title.page")});var Yt=a(43267);var Xt=a(65504);const ea=(0,i.memo)((function(){const{userId:e=""}=(0,r.g)(),t=decodeURIComponent(e),a=(0,s.Qj)(t).toURI(),i=(e=>{const t=(0,He.V)(),a=(0,Yt.C)()?.username;return!t&&a===e})(t);return(0,p.jsx)("section",{children:(0,p.jsxs)(r.BV,{children:[(0,p.jsx)(r.qh,{path:"playlists",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE_PLAYLISTS,children:(0,p.jsx)(Vt,{uri:a})})}),(0,p.jsx)(r.qh,{path:"top/tracks",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE_TOP_TRACKS,children:(0,p.jsx)(qt,{uri:a,isCurrentUser:i})})}),(0,p.jsx)(r.qh,{path:"top/artists",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE_TOP_ARTISTS,children:(0,p.jsx)(zt,{isCurrentUser:i})})}),(0,p.jsx)(r.qh,{path:"recently-played-artists",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE_RECENTLY_PLAYED_ARTISTS,children:(0,p.jsx)(Kt,{uri:a})})}),(0,p.jsx)(r.qh,{path:"following",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE_FOLLOWING,children:(0,p.jsx)(f,{uri:a})})}),(0,p.jsx)(r.qh,{path:"followers",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE_FOLLOWERS,children:(0,p.jsx)(h,{uri:a})})}),(0,p.jsx)(r.qh,{path:"/",element:(0,p.jsx)(Xt.e,{pageId:o.$h.PROFILE,children:(0,p.jsx)(Gt,{uri:a,isCurrentUser:i})})})]})})}))},43267:(e,t,a)=>{a.d(t,{C:()=>o});a(1137);var i=a(85980),r=a(23e3);const o=()=>{const e=(0,i.d4)((e=>e.session?.user));return e?{type:r.c.USER,uri:e.uri,username:e.id,displayName:e.display_name??null,images:e.images.map((({url:e,width:t,height:a})=>({url:e,width:t||void 0,height:a||void 0})))}:null}},65553:(e,t,a)=>{a.d(t,{a:()=>i});const i=e=>e?.linked_from?.uri||e.uri},22726:(e,t,a)=>{a.d(t,{b:()=>o,g:()=>r});var i=a(79474);let r=function(e){return e[e.loading=0]="loading",e[e.loaded=1]="loaded",e[e.error=2]="error",e}({});function o(e,t){const a=e?r.loading:r.error,[o,s]=(0,i.useState)(a);return(0,i.useEffect)((()=>{const a=()=>{s(r.loaded)},i=()=>{s(r.error)};if(!e)return s(r.error),()=>{};s(r.loading);const o=document.createElement("img");return o.addEventListener("load",a),o.addEventListener("error",i),o.setAttribute("src",e),t&&o.setAttribute("srcSet",t),()=>{o.removeEventListener("load",a),o.removeEventListener("error",i)}}),[e,t]),o}}}]);
//# sourceMappingURL=xpui-routes-profile.js.map