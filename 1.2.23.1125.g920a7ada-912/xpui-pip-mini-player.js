"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[1963],{49481:(e,t,i)=>{i.r(t),i.d(t,{PiPMiniPlayer:()=>Ce,TEST_IDS:()=>pe});var n=i(59496),a=i(84875),o=i.n(a),l=i(90075),r=i(36032),s=i(32554),c=i(86961),u=(i(82346),i(23755),i(25878)),d=i(149),m=i(39313),k=i(94898),g=i(6894),h=i(19882),p=i(96581),C=i(90266),x=i(74446),f=i(66258),y=i(57941),v=i(73049),b=i(41246),w=i(67268),j=i(33335),S=i(32431);const B="gXC4vnPDiiiiawwnDN6i",N="HGOZPJuKeigRY5I0vqQw",E="AZLdtyFhMa1Aqml2YhF2",P="QfiWYSeXiPwGYmKED38q";var R=i(4637);const T=({item:e,onClick:t,className:i})=>{const n=(0,v.QR)(e),a=(0,p.k6)(e)?n?.title:e.name,l=(0,p.k6)(e)?n?.subtitle:e.name,r="SMALL"===(0,y.G)().vertical;return(0,R.jsxs)("div",{className:o()(B,i),children:[(0,R.jsx)("div",{className:N,children:(0,R.jsx)(j.R,{title:a,children:(0,R.jsx)(f.D,{"data-testid":"context-item-info-title",as:"div",variant:r?"ballad":"celloCanon",className:N,dir:"auto",children:(0,R.jsx)(w.b,{item:e,onClick:t,adUrl:n?.url,children:a})})},e.uri)}),(0,R.jsx)(S.t,{className:P,item:e}),(0,R.jsx)("div",{className:E,children:(0,R.jsx)(j.R,{title:l,children:(0,R.jsx)(f.D,{"data-testid":"context-item-info-subtitles",as:"div",variant:"mesto",className:E,semanticColor:"textSubdued",children:(0,R.jsx)(b._,{item:e,onClick:t,adSubtitle:l,adBlurbUri:n?.blurbUri,adUrl:n?.url?n?.url:void 0})})},e.uri)})]})};var F=i(14486),I=i(85830),O=i(55489),V=i(69117),L=i(9377),_=i(57272),A=i(78790),D=i(94091),M=i(71941),H=i(66905),W=i(67960);function z(e){return{itemToBeSkipped:e.item?.uri||"",positionMs:(0,H.k)(e)??-1,totalContentMs:e.duration??-1}}function U(e){return Math.floor(100*e)}const q="E7rR1kkQFoqCTrZAxs8l",Z="I2v17dp_FDztHzG7CZy9",G="H5VJw6yCxUOoh88LJ42y",K=n.memo((({item:e,spec:t,logger:i})=>{const a=e.uri,{onClickPlayPause:o,onClickLike:l,onClickSkipPrevious:r,onClickSkipNext:s,onClickRepeat:c,onClickShuffle:u,onClickVolumeButton:d,onClickVolumeBar:m,onDragVolumeBar:k,onClickSeekBack:g,onClickSeekForward:h}=(({uri:e,spec:t,logger:i})=>{const a=(0,n.useRef)(e);a.current=e;const o=(0,M.g)(),l=(0,n.useMemo)((()=>t.playerControlsFactory()),[t]),r=(0,n.useCallback)((e=>{let t=null;a.current&&("pause"===e?t=l.playPauseButtonFactory().hitPause({itemToBePaused:a.current}):"resume"===e&&(t=l.playPauseButtonFactory().hitResume({itemToBeResumed:a.current})),t&&i.logInteraction(t))}),[i,l]),s=(0,n.useCallback)((e=>{if(!a.current)return;const t=l.likeButtonFactory(),n=e?t.hitLike({itemToBeLiked:a.current}):t.hitRemoveLike({itemNoLongerLiked:a.current});i.logInteraction(n)}),[i,l]),c=(0,n.useCallback)((()=>{const e=o.getState();if(!e)return;const t=l.previousButtonFactory().hitSkipToPrevious(z(e));i.logInteraction(t)}),[i,o,l]),u=(0,n.useCallback)((()=>{const e=o.getState();if(!e)return;const t=l.nextButtonFactory().hitSkipToNext(z(e));i.logInteraction(t)}),[i,o,l]),d=(0,n.useCallback)((e=>{const t=l.repeatButtonFactory();let n=null;switch(e){case p.zq.REPEAT_TRACK:n=t.hitRepeatOneEnable();break;case p.zq.REPEAT_CONTEXT:n=t.hitRepeatEnable();break;case p.zq.REPEAT_NONE:n=t.hitRepeatDisable();break;default:(0,W._)(e)}n&&i.logInteraction(n)}),[i,l]),m=(0,n.useCallback)((e=>{if(!a.current)return;const t=e?"shuffle":"linear",n=e?"linear":"shuffle",o=l.shuffleButtonFactory({uri:a.current}).hitSelectShuffleMode({previousMode:n,selectedMode:t});i.logInteraction(o)}),[i,l]),k=(0,n.useCallback)((e=>{const t=l.volumeMuteButtonFactory();i.logInteraction("muted"===e?t.hitMutePlayback():t.hitUnmutePlayback())}),[i,l]),g=(0,n.useCallback)((e=>{const t=l.volumeBarFactory();i.logInteraction(t.hitSetVolume({newVolumePercentage:U(e)}))}),[i,l]),h=(0,n.useCallback)((e=>{const t=l.volumeBarFactory();i.logInteraction(t.dragSetVolume({newVolumePercentage:U(e)}))}),[i,l]),C=(0,n.useCallback)((e=>{const t=l.seekBackwardButtonFactory();i.logInteraction(t.hitSeekByTime({msSeekedOffset:e}))}),[i,l]);return{onClickSeekForward:(0,n.useCallback)((e=>{const t=l.seekForwardButtonFactory();i.logInteraction(t.hitSeekByTime({msSeekedOffset:e}))}),[i,l]),onClickSeekBack:C,onClickPlayPause:r,onClickLike:s,onClickSkipPrevious:c,onClickSkipNext:u,onClickRepeat:d,onClickShuffle:m,onClickVolumeButton:k,onClickVolumeBar:g,onDragVolumeBar:h}})({uri:a,spec:t,logger:i}),C=(0,y.G)(),x=(0,I.y1)(k,500,{leading:!1,trailing:!0});if(!a)return null;const f=(0,V.G)(e),v=(0,O.i)(e),b=function(e){if((0,O.i)(e)||(0,p.G7)(e))return"audio"===e.mediaType||"mixed"===e.mediaType;return!1}(e),w="SMALL"===C.horizontal;return"SMALL"===C.vertical?(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(A.IF,{onClick:o}),b?(0,R.jsx)(A.Of,{onClick:h}):(0,R.jsx)(A.C$,{onClick:s})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("div",{className:q,children:[f&&(0,R.jsx)(_.B,{uri:a,onClick:l,className:Z}),v&&(0,R.jsx)(L.w,{uri:a,onClick:l,className:Z})]}),b?(0,R.jsx)(A.FP,{onClick:g}):(0,R.jsx)(A.P4,{onClick:u}),(0,R.jsx)(A.Wu,{onClick:r}),(0,R.jsx)(A.IF,{iconSize:w?"small":"medium",onClick:o,className:G}),(0,R.jsx)(A.C$,{onClick:s}),b?(0,R.jsx)(A.Of,{onClick:h}):(0,R.jsx)(A.$Z,{onClick:c}),(0,R.jsx)(D.h,{mode:D.R.SHOW_SLIDER_ON_HOVER,sliderSize:80,sliderDirection:"vertical",onToggleMuteClick:d,onVolumeBarClick:m,onVolumeBarDrag:x})]})}));var Q=i(49520),X=i(98424),Y=i(59252),J=i(66422),$=i(19012);var ee=i(5746);var te=i(52951);function ie(e){if(!e)return null;return{width:e.innerWidth,height:e.innerHeight}}const ne="transparent",ae="AFZj_hxk7gFsvDDwhsHA",oe="UJwngpM5puDW7Frkha4F",le="ktiXGqfcVuegTncUQJim",re="EzVSQ6md_ZPcpGd373uw",se="xM5DXnNVIBKl0D8KmkKr",ce="xZLIxv5s2tm_tmFk3WK8",ue="X_fBDy8Kj2NkVB4npQT3",de="yMMglN43dvX2QKTUoivA",me="D0BU1OBnl1EjBDosrWXn",ke="tKfqdd6glswVG49yHgiT",ge="Hbbk972I34uVuWeqBn2Q",he="xI3ObXOh1ql5ZWoAUyff",pe={HOVER_CONTAINER:"document-pip-hover-element",COVER_ART:"document-pip-cover-art",COVER_ART_PLACEHOLDER:"document-pip-cover-art-placeholder"},Ce=n.memo((()=>{const{item:e,context:t}=(0,X.x)()??{},[i,a]=(0,n.useState)(!1),f=640,y=(0,n.useMemo)((()=>(0,x.o)(e?.images??void 0,{desiredSize:f})),[e?.images,f]),v=(0,m.b)(y,ne),b=(0,r.W6)(Q.YZd);((e,t)=>{const i=(0,ee.Y)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri)),a=(0,n.useMemo)((()=>(0,x.o)(i?.images??void 0,{desiredSize:e})),[i?.images,e]);(0,m.b)(a,t)})(f,ne);const{spec:w,logger:j}=(0,C.fU)(s.O,{}),S=(0,C.Wi)(w);(({spec:e,logger:t})=>{const i=(0,$.zY)(),a=(0,n.useRef)(null);null===a.current&&(a.current=ie(i)),(0,te.a)((()=>{const n=ie(i);null!==n&&null!==a.current&&(t.logInteraction(e.dragUiResize2d({startWidthPx:a.current.width,startHeightPx:a.current.height,endWidthPx:n.width,endHeightPx:n.height})),a.current=n)}),{throttleTime:500,leading:!1,trailing:!0})})({logger:j,spec:w}),(({spec:e,logger:t,pipWindow:i})=>{(0,n.useEffect)((()=>{if(!i)return;const n=n=>{if(n.currentTarget===i){const i=e.windowControlsFactory().closeButtonFactory().hitUiHide();t.logInteraction(i)}};return i.addEventListener("pagehide",n),()=>{i.removeEventListener("pagehide",n)}}),[t,i,e])})({logger:j,spec:w,pipWindow:window.documentPictureInPicture?.window??null});const{setVideoPlayerUIFlag:B}=(0,Y.l)(),{isPlayingRemotely:N}=(0,k.H)(),[E,P]=(0,n.useState)("");(0,n.useLayoutEffect)((()=>{P(oe)}),[]),(0,n.useEffect)((()=>{b&&B(J.x.documentPip,!0)}),[b,B]);const I=(0,n.useCallback)((e=>{if((t=e.target)&&"object"==typeof t&&"nodeName"in t&&"A"===t.nodeName&&"_blank"!==e.target.target){(0,g.ZO)()===h.W.Desktop?window?.showMainWindow?.():a(!0)}var t}),[]);((e,t)=>{const i=(0,$.zY)(),a=t??i;(0,n.useEffect)((()=>{e&&a&&(a.document.title=e)}),[e,a])})(c.ag.get("web-player.pip-mini-player.window-title"));const O=(0,n.useCallback)((()=>{a(!1)}),[]);if(!e||!t)return null;const V={"--background-color":v,"--background-image-url":`url(${y})`,"--background-image-width":"640px","--background-image-height":"640px",display:"var(--mini-player-display)"},L=(0,p.iw)(e)&&("video"===e.mediaType||"mixed"===e.mediaType);let _=!L;return!L||!N&&b||(_=!0),(0,R.jsxs)("div",{className:ae,style:{"--mini-player-display":"none"},children:[(0,R.jsxs)("div",{className:o()("encore-dark-theme",le),style:V,ref:S,children:[(0,R.jsx)("div",{className:o()(se,{[ce]:!L}),"data-testid":"pip-hover-element",children:(0,R.jsx)("div",{className:ue,id:"document-pip-main-container",children:_&&(0,R.jsx)(d.Ee,{className:de,src:y,loading:"eager",testid:pe.COVER_ART,children:(0,R.jsx)("div",{className:me,children:(0,R.jsx)(u.t,{size:"xlarge",type:e.type,"data-testid":pe.COVER_ART_PLACEHOLDER})})})})}),(0,R.jsx)(T,{item:e,className:he,onClick:I}),(0,R.jsx)("div",{className:o()("encore-over-media-set",ke,{[ge]:!(0,p.k6)(e)}),dir:"ltr","data-testid":pe.HOVER_CONTAINER,children:(0,R.jsx)(K,{item:e,spec:w,logger:j})})]}),(0,R.jsx)("div",{className:E,children:(0,R.jsx)(F.E,{fadeIn:!1})}),(0,R.jsx)(l.A9,{colorSet:"invertedLight",showSnackbar:i,onExited:O,className:re,children:c.ag.get("web-player.pip-mini-player.snackbar.link-opened-in-main-window")})]})}))}}]);
//# sourceMappingURL=xpui-pip-mini-player.js.map