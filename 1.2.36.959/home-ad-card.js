"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[599,7968],{86904:(e,a,t)=>{t.d(a,{U:()=>l});var s=t(14056),r=t(96608),n=t(65325),i=t(13274);const l=({menu:e,onClick:a,"aria-label":t})=>(0,i.jsx)(n.b,{menu:e,children:(0,i.jsx)(r.e,{size:r.M.xs,label:s.Ru.get("more"),ariaLabel:t,onClick:a})})},17968:(e,a,t)=>{t.r(a),t.d(a,{CtaButton:()=>d,default:()=>c});var s=t(79474),r=t(98258),n=t(59841),i=t(61080),l=t(32371),o=t(13274);const d=({"aria-label":e,text:a,onClick:t,clickUrl:d,backgroundColor:c,className:u})=>{const m=(0,s.useMemo)((()=>{if(!c)return;const e=(0,r.mA)(c);return{...e,text:{...e.text,base:n.solidWhite200}}}),[c]);return(0,o.jsx)(l.Link,{"aria-label":e||a,className:u,"data-testid":"ad-cta-button",to:d,onClick:e=>{e.stopPropagation(),t()},children:(0,o.jsx)(i.$,{UNSAFE_colorSet:m,colorSet:"invertedLight",size:"small",children:a})})},c=d},39233:(e,a,t)=>{t.r(a),t.d(a,{default:()=>Le});var s=t(79474),r=t(97500),n=t.n(r),i=t(90923),l=t(65969),o=t(52058),d=t(14056),c=t(86904),u=t(70315),m=t(44366),y=t(18702),x=t(95999),h=t(20273),v=t(53603),f=t(13274);const b=(0,s.memo)((function({onDismissAdClick:e}){return(0,f.jsx)(x.pZ,{value:"home-ad",children:(0,f.jsx)(h.W,{children:(0,f.jsx)(x.pZ,{value:"dismiss",children:(0,f.jsx)(v.D,{role:"menuitem",leadingIcon:(0,f.jsx)(y.P,{size:"small"}),"aria-label":d.Ru.get("ad-formats.context-menu.not-interested"),onClick:e,children:d.Ru.get("ad-formats.context-menu.not-interested")})})})})}));var P=t(94710),k=t(3273),g=t(77977),j=t(17968);const p="UVbywzVz7Cs6U0CEvzU7",A="SUMHUXdQtJRZvE0wNsLA",C=({className:e,homeAd:a,dismiss:t})=>{const s=(0,P.vh)(),r=(0,u.L)(),i=n()(p,e),{extractedHomeAdColor:[y]}=(0,g.bT)(),x=(0,m.w)(m.P),h=(0,k.A)((()=>{t();const e="collapsed";r.log(`event_${e}`,a),a.trackingEvents[e]?.urls.forEach(x),s.send((0,o.F)({ad_id:a.adId,advertiser:a.metadata.advertiser,creative_id:a.metadata.creative_id,event:"dislike_HPTO",format:(0,l.gh)(a.format),line_item_id:a.metadata.line_item_id}))})),v=(0,k.A)((()=>{const e="clicked";r.log(`event_${e}`,a),a.trackingEvents[e]?.urls.forEach(x)})),C=a.metadata.buttonText||d.Ru.get("ad-formats.learnMore");return(0,f.jsxs)("div",{className:i,children:[a.clickthroughUrl&&(0,f.jsx)(j.CtaButton,{className:A,"aria-label":`${C}, link`,text:C,clickUrl:a.clickthroughUrl,onClick:v,backgroundColor:y?.colorDark}),(0,f.jsx)(c.U,{"aria-label":"More options, button",menu:(0,f.jsx)(b,{onDismissAdClick:h})})]})};var E=t(98764),N=t(32371);const _="HnLHs_xuuJMSTrREcuO1",U=({className:e,description:a,label:t,homeAd:s})=>{const r=n()(_,e),{clickthroughUrl:i,metadata:{tagline:l}}=s,o=(0,m.w)(m.P),d=(0,u.L)(),c=(0,k.A)((()=>{if(!i)return;const e="clicked";d.log(`event_${e}`,s),s.trackingEvents[e]?.urls.forEach(o)}));return(0,f.jsxs)("div",{className:r,children:[t&&(0,f.jsx)(E.E,{variant:"bodyMedium",children:t}),l&&(0,f.jsx)(N.Link,{to:i,onClick:c,"aria-label":`${l}, link`,children:(0,f.jsx)(E.E,{variant:"titleMedium",children:l})}),a&&(0,f.jsx)(E.E,{variant:"bodySmall",children:a})]})};var R=t(2394),M=t(48761),S=t(75783);const V="rLoSLtWsmOdhdiNz3r17",L=({className:e,homeAd:a})=>{const{metadata:{advertiser:t,logoImage:s},clickthroughUrl:r}=a,i=(0,m.w)(m.P),l=(0,u.L)(),o=(0,k.A)((()=>{if(!r)return;const e="clicked";l.log(`event_${e}`,a),a.trackingEvents[e]?.urls.forEach(i)}));return(0,f.jsx)(N.Link,{"aria-label":`${t}, Advertisement, link`,className:n()(e,V),to:r,onClick:o,children:(0,f.jsx)(R.v,{id:"advertiser-info",isInteractive:!1,media:s,padding:"0",subtitle:(0,f.jsx)(M.j,{children:d.Ru.get("ad-formats.advertisement")}),title:(0,f.jsx)(S.d,{children:t})})})};var w=t(38074),z=t(29037),T=t(72423),O=t(83856);function W(e){for(const{imageFileId:a,url:t}of e.display){if(a){const e=(0,O.CC)(a).toURI();if(e)return e}if(t)return t}}const I="acMBKZuLlROUat0sL2a_",D=({className:e,icon:a,...t})=>(0,f.jsx)("div",{className:n()(I,e),...t,children:a});function H(e){const{imageUrlToExtractHomeAdColorFrom:[,a]}=(0,g.bT)();(0,s.useEffect)((()=>a(e)),[e,a]),(0,s.useEffect)((()=>()=>a(void 0)),[a])}const $="lNTmTLY8RhoIIjrz4eyI",F=({className:e,displayAssetUrl:a,homeAd:t})=>{const r=(0,m.w)(m.P),n=(0,u.L)(),i=(0,k.A)((()=>{const e="viewed";n.log(`event_${e}`,t),t.trackingEvents[e]?.urls.forEach(r)})),l=(0,k.A)((()=>{const e="clicked";n.log(`event_${e}`,t),t.trackingEvents[e]?.urls.forEach(r)}));return(0,s.useEffect)((()=>i()),[i]),(0,f.jsx)(N.default,{to:t.clickthroughUrl,className:e,onClick:l,children:(0,f.jsx)(T._,{className:$,testid:"home-ad-display-asset",loading:"lazy",src:a,children:(0,f.jsx)(D,{icon:(0,f.jsx)(w.b,{})})})})},B=({className:e,homeAd:a})=>{const t=(0,s.useMemo)((()=>W(a)),[a]);return H(t),t?(0,f.jsx)(F,{className:e,homeAd:a,displayAssetUrl:t}):(0,f.jsx)(D,{className:e,icon:(0,f.jsx)(z.c,{size:"large"}),"data-testid":"home-ad-display-asset-fallback"})};var q=t(30232),G=t(69632),Z=t(37693),J=t(17122),Q=t(28072),Y=t(70964),K=t(87737);const X=s.useState;var ee=t(86714);var ae=t(88903),te=t(48912),se=t(91373);function re(e,a,t){return new ae.A({mediaExtensions:[new te.h(e)],factories:[t]}).createBetamaxPlayer({videoElementConfig:{controls:!1,loop:!0},containerElement:a,networkConfiguration:{getAuthorizationHeader:async()=>{const{accessToken:e,tokenType:a}=await se.l.get("sp://oauth/v2/token");return`${a} ${e}`}}})}async function ne(e,{mediaUrl:a,playback_id:t,playWhenReady:s}){return await e.play({mediaUrl:a,isRoyaltyMedia:!1,metadata:{playback_id:t}},{playWhenReady:s})}var ie=t(61080),le=t(59088),oe=t(37862),de=t(37463),ce=t(54015),ue=t(87687);const me="CvDxC6yzLZR5903EyQ0h",ye="GGTDIWvbV_0GOFxz7Wnb",xe="TZHv075bCzIMSxvLxFDH",he="FDvo9DrWfSMYVubh78Oa",ve=({betamaxPlayer:e,muted:a,paused:t,isContextPlayerVideoPlaying:s,isContextPlayerPlaybackPaused:r})=>{const n=(0,ue.K)();return(0,f.jsxs)("div",{className:me,children:[(0,f.jsx)("div",{className:xe,children:a?(0,f.jsx)(ie.$,{"aria-label":"Unmute, button",colorSet:"overMedia",iconOnly:le.X,onClick:()=>{e.setAudioDisabled(!1),!n.getState()?.item||s||r||n.pause()},size:"small"}):(0,f.jsx)(ie.$,{"aria-label":"Mute, button",colorSet:"overMedia",iconOnly:oe.z,onClick:()=>e.setAudioDisabled(!0),size:"small"})}),(0,f.jsx)("div",{className:he,children:t?(0,f.jsx)(ie.$,{"aria-label":"Play, button",colorSet:"overMedia",iconOnly:de.A,onClick:()=>{e.resume(),n.getState()?.item&&s&&!r&&n.pause()},size:"medium"}):(0,f.jsx)(ie.$,{"aria-label":"Pause, button",className:ye,colorSet:"overMedia",iconOnly:ce._,onClick:()=>e.pause(),size:"medium"})})]})},fe="JS7sJfGVY9xjxR3eWJVq",be=({homeVideoAd:e})=>{const a=(0,s.useMemo)((()=>W(e)),[e]);return a?(0,f.jsx)(F,{className:fe,displayAssetUrl:a,homeAd:e}):(0,f.jsx)(D,{className:fe,icon:(0,f.jsx)(w.b,{})})},Pe=({assetUrl:e,homeVideoAd:a,isContextPlayerVideoPlaying:t,isContextPlayerPlaybackPaused:r,videoContainerElement:n,createVideoPlayer:i=re,playVideoPlayer:l=ne})=>{const{betamaxPlayer:o,setBetamaxPlayer:d}=function(){const[e,a]=X();return{betamaxPlayer:e,setBetamaxPlayer:a}}(),c=(0,m.w)(m.P),y=(0,u.L)(),x=!t||r,{muted:h,paused:v,loading:b,errored:P=!0,observerFactory:g}=function(e,a,t,r){const[n,i]=(0,s.useState)(!0),[l,o]=(0,s.useState)(!r),[d,c]=(0,s.useState)(!0),[u,m]=(0,s.useState)(!1);return{muted:n,paused:l,loading:d,errored:u,observerFactory:(0,s.useCallback)((()=>{let s=0;const r=(e,s)=>{a.log(`event_${e}`,s),s.trackingEvents[e]?.urls.forEach(t)},n=(e,a)=>{const t=(e=>{switch(e){case"started":return 1;case"first_quartile":return 2;case"midpoint":return 3;case"third_quartile":return 4;case"ended":case"error":return 5;default:return null}})(e);t?t>s&&(s=t,r(e,a)):r(e,a)};return{onStarted(){n("viewed",e),n("started",e),o(!1)},onResumed(){o((a=>(a&&n("resumed",e),!1)))},onPaused(){o(!0),n("paused",e)},onVolumeChanged({volume:a}){const t=a<=0;i(t),n(t?"muted":"unmuted",e)},onPlaybackCreated({timeObservable:a}){a.addObserverForMediaPositions([.25,.5,.75],(a=>{a>=.25&&n("first_quartile",e),a>=.5&&n("midpoint",e),a>=.75&&n("third_quartile",e)}))},onPlaybackEnded({reason:a}){switch(a){case ee.mT.FATAL_ERROR:case ee.mT.NETWORK_ERROR:n("error",e);break;case ee.mT.PLAYED_TO_END:n("ended",e)}},onReady(){c(!1)},onPlaybackError(){c(!1),m(!0)}}}),[t,e,a])}}(a,y,c,x),j=(0,s.useMemo)((()=>(0,Y.U5)((0,Y.sH)(a.adId))),[a.adId]),p=function({assetUrl:e,createVideoPlayer:a,playVideoPlayer:t,observerFactory:s,playback_id:r,playWhenReady:n,muted:i}){return(0,k.A)((async({videoContainerElement:l,"video-manifest-url":o})=>{try{return await t(a(o,l,s).setAudioDisabled(i),{mediaUrl:e,playback_id:r,playWhenReady:n})}catch(e){return}}))}({assetUrl:e,createVideoPlayer:i,playVideoPlayer:l,observerFactory:g,playback_id:j,playWhenReady:x,muted:h});return function({videoContainerElement:e,initializeBetamaxPlayer:a,setBetamaxPlayer:t}){const r=(0,K.l)(),n=(0,s.useRef)(),i=(0,s.useRef)();(0,s.useEffect)((()=>{const s=r.getProductState();n.current=s;const l=s.then((t=>{if(s===n.current){const s=t?.["video-manifest-url"];if(s)return a({videoContainerElement:e,"video-manifest-url":s})}}));i.current=l,t(l),l.then((e=>{l===i.current&&t(e)}))}),[r,a,e,t])}({videoContainerElement:n,initializeBetamaxPlayer:p,setBetamaxPlayer:d}),function({betamaxPlayer:e,assetUrl:a,playVideoPlayer:t,playback_id:r,playWhenReady:n}){const i=(0,k.A)((async a=>{e instanceof J.M&&await t(e,{mediaUrl:a,playback_id:r,playWhenReady:n})}));(0,s.useEffect)((()=>{i(a)}),[a,i])}({betamaxPlayer:o,assetUrl:e,playVideoPlayer:l,playback_id:j,playWhenReady:x}),((e,a,t=!1)=>{(0,s.useEffect)((()=>{e instanceof J.M&&!t&&(a?e.pause():e.setAudioDisabled(!0))}),[t,a,e])})(o,t,r),function({betamaxPlayer:e}){(0,s.useEffect)((()=>e instanceof J.M?()=>{e.release()}:void 0),[e])}({betamaxPlayer:o}),b?(0,f.jsx)(D,{className:fe,icon:(0,f.jsx)(Q.a3,{"aria-label":"Loading"})}):P?(0,f.jsx)(be,{homeVideoAd:a}):o instanceof J.M?(0,f.jsx)(ve,{betamaxPlayer:o,muted:h,paused:v,isContextPlayerVideoPlaying:t,isContextPlayerPlaybackPaused:r}):null},ke="WJllnHWGxXydlZGNRZiO",ge="r0vbWTxR_IGYTZyvgFMh",je=({assetUrl:e,className:a,homeVideoAd:t})=>{const[r,i]=(0,s.useState)(null),{isContextPlayerVideoPlaying:l,isContextPlayerPlaybackPaused:o}=(0,q.o)((e=>({isContextPlayerVideoPlaying:(0,G.A3)(e),isContextPlayerPlaybackPaused:e?.isPaused})),Z.a);return H((0,s.useMemo)((()=>t.metadata.logoImage||W(t)),[t])),(0,f.jsxs)("div",{className:n()(ke,a),ref:i,children:[(0,f.jsx)("div",{className:ge}),r&&(0,f.jsx)(Pe,{homeVideoAd:t,assetUrl:e,videoContainerElement:r,isContextPlayerVideoPlaying:l,isContextPlayerPlaybackPaused:o})]})};var pe=t(19590);var Ae=t(79698);const Ce="Xhum81gqJ9_yzyRPrZL3",Ee="Hh0BfFLHoMSS13mEamTm",Ne="vxupx_DPthzcIIGk5P7S",_e="bMPG2OQYQ35X5SIDff2b",Ue="HnN095GFBE_RxE12Q8xQ",Re="YOew7m8HjK6o5WVtRQBA",Me="doOUxCoVWqql8Wi4Kogb",Se="e1aSqLJjB7Lrqc5UH1iO",Ve=(0,Ae.H)((({homeAd:e,dismiss:a},t)=>{const r=(0,s.useMemo)((()=>{if(a=e,(0,l.pq)(a.format)===l.nM.VIDEO){const a=function(e){for(const{videoManifestId:a,url:t}of e.video){if(a){const e=pe.DJ.create(a);if(e)return e}if(t)return t}}(e);if(a)return{homeAd:e,videoAssetUrl:a}}var a}),[e]);return(0,f.jsx)("div",{className:n()(Ce,"contentSpacing",{[Ee]:(0,i.A)()}),ref:t,children:(0,f.jsx)("div",{className:Ne,children:(0,f.jsxs)("div",{className:_e,children:[r?(0,f.jsx)(je,{className:Ue,homeVideoAd:r.homeAd,assetUrl:r.videoAssetUrl}):(0,f.jsx)(B,{className:Ue,homeAd:e}),(0,f.jsx)(L,{className:Re,homeAd:e}),(0,f.jsx)(U,{className:Me,homeAd:e}),(0,f.jsx)(C,{className:Se,dismiss:a,homeAd:e})]})})})})),Le=(0,Ae.H)((({homeAd:e},a)=>{const{dismissed:t,dismiss:s}=(0,g.bT)();return t?null:(0,f.jsx)(Ve,{homeAd:e,dismiss:s,ref:a})}))},70315:(e,a,t)=>{t.d(a,{L:()=>r});var s=t(77977);const r=()=>{const{logger:e}=(0,s.bT)();return e}}}]);
//# sourceMappingURL=home-ad-card.js.map